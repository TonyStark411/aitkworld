<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<meta name="description" content="AITK â€” The AI Economy Token. Buy, sell, and use AI services with AITK on Polygon.">
<meta property="og:title" content="AITK â€” Power the AI Economy">
<meta property="og:description" content="The native token for decentralized AI services on Polygon.">
<meta name="theme-color" content="#050810">
<title>AITK â€” Power the AI Economy</title>
<link href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500;700&family=Instrument+Sans:wght@400;500;600&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/6.7.0/ethers.umd.min.js"></script>
<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DESIGN SYSTEM
   Aesthetic: Cyberpunk Finance â€” dark luxury with electric
   neon accents. Inspired by Bloomberg terminals + Web3 UX.
   Typography: Bricolage Grotesque (display) + JetBrains Mono (data)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
:root {
  --bg:       #03050d;
  --bg2:      #060a14;
  --bg3:      #0a1020;
  --card:     #0d1528;
  --card2:    #111d35;
  --border:   rgba(56,139,253,0.1);
  --border2:  rgba(56,139,253,0.2);

  --cyan:     #00d4ff;
  --cyan2:    #0099cc;
  --green:    #00ff88;
  --purple:   #9d4edd;
  --pink:     #ff006e;
  --amber:    #ffbe0b;

  --text:     #e2eaff;
  --text2:    #8899bb;
  --text3:    #4a5a7a;

  --glow-c:   rgba(0,212,255,0.15);
  --glow-g:   rgba(0,255,136,0.12);
  --glow-p:   rgba(157,78,221,0.15);

  --r:        14px;
  --r2:       20px;
  --r3:       28px;

  --font-display: 'Bricolage Grotesque', sans-serif;
  --font-mono:    'JetBrains Mono', monospace;
  --font-body:    'Instrument Sans', sans-serif;

  --nav-h: 68px;
}

/* RESET */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-behavior: smooth; font-size: 16px; }
body {
  background: var(--bg);
  color: var(--text);
  font-family: var(--font-body);
  min-height: 100vh;
  overflow-x: hidden;
  -webkit-font-smoothing: antialiased;
}
a { color: inherit; text-decoration: none; }
button { font-family: inherit; cursor: pointer; }
input, textarea { font-family: inherit; }

/* â”€â”€ CANVAS BACKGROUND â”€â”€ */
#bg-canvas {
  position: fixed; inset: 0; z-index: 0;
  pointer-events: none; opacity: 0.4;
}

/* â”€â”€ GRAIN OVERLAY â”€â”€ */
body::before {
  content: '';
  position: fixed; inset: 0; z-index: 1;
  pointer-events: none;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.04'/%3E%3C/svg%3E");
  opacity: 0.3;
}

.z1 { position: relative; z-index: 2; }

/* â”€â”€ CONTAINER â”€â”€ */
.wrap { max-width: 1200px; margin: 0 auto; padding: 0 20px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   NAVIGATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
nav {
  position: fixed; top: 0; left: 0; right: 0;
  height: var(--nav-h); z-index: 200;
  background: rgba(3,5,13,0.85);
  backdrop-filter: blur(24px) saturate(180%);
  border-bottom: 1px solid var(--border);
}
.nav-wrap {
  display: flex; align-items: center;
  justify-content: space-between;
  height: 100%; gap: 16px;
}
.logo {
  display: flex; align-items: center; gap: 10px;
  flex-shrink: 0;
}
.logo-icon {
  width: 38px; height: 38px;
  background: linear-gradient(135deg, var(--cyan), var(--purple));
  border-radius: 10px;
  display: flex; align-items: center; justify-content: center;
  font-family: var(--font-display); font-weight: 800; font-size: 13px;
  color: #fff; letter-spacing: -0.5px;
  box-shadow: 0 0 20px rgba(0,212,255,0.35);
  flex-shrink: 0;
}
.logo-name {
  font-family: var(--font-display); font-weight: 800;
  font-size: 22px; letter-spacing: -0.5px;
}
.logo-name em { color: var(--cyan); font-style: normal; }

/* Nav tabs */
.nav-tabs {
  display: flex; gap: 2px;
  background: rgba(255,255,255,0.03);
  border: 1px solid var(--border);
  border-radius: 12px; padding: 4px;
  overflow-x: auto;
  scrollbar-width: none;
}
.nav-tabs::-webkit-scrollbar { display: none; }
.ntab {
  padding: 8px 16px; border-radius: 9px;
  font-size: 13px; font-weight: 600;
  color: var(--text2); border: none;
  background: transparent;
  transition: all 0.2s; white-space: nowrap;
  display: flex; align-items: center; gap: 6px;
}
.ntab:hover { color: var(--text); background: rgba(255,255,255,0.04); }
.ntab.on { background: rgba(0,212,255,0.1); color: var(--cyan); }
.ntab .ti { font-size: 14px; }

/* Nav right */
.nav-right { display: flex; align-items: center; gap: 8px; flex-shrink: 0; }

.net-pill {
  display: flex; align-items: center; gap: 6px;
  padding: 6px 12px; border-radius: 20px;
  font-size: 12px; font-weight: 600;
  background: rgba(157,78,221,0.12);
  border: 1px solid rgba(157,78,221,0.25);
  color: #c084fc;
}
.net-pill .dot {
  width: 6px; height: 6px; border-radius: 50%;
  background: #a855f7; animation: blink 2s infinite;
}
.net-pill.bad { background: rgba(255,0,110,0.1); border-color: rgba(255,0,110,0.25); color: var(--pink); }
.net-pill.bad .dot { background: var(--pink); }

.btn-connect {
  background: linear-gradient(135deg, var(--cyan), #0066cc);
  color: #fff; border: none;
  padding: 10px 20px; border-radius: 10px;
  font-family: var(--font-display); font-weight: 700;
  font-size: 13px; letter-spacing: 0.2px;
  transition: all 0.2s;
  box-shadow: 0 0 24px rgba(0,212,255,0.25);
}
.btn-connect:hover { transform: translateY(-1px); box-shadow: 0 0 36px rgba(0,212,255,0.4); }

.wallet-chip {
  display: flex; align-items: center; gap: 8px;
  background: var(--card); border: 1px solid var(--border2);
  padding: 8px 14px; border-radius: 10px;
  font-family: var(--font-mono); font-size: 12px;
  cursor: pointer; transition: border-color 0.2s;
}
.wallet-chip:hover { border-color: rgba(0,212,255,0.4); }
.w-dot { width: 8px; height: 8px; background: var(--green); border-radius: 50%; flex-shrink: 0; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LIVE TICKER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.ticker-bar {
  position: fixed; top: var(--nav-h); left: 0; right: 0;
  z-index: 199; overflow: hidden;
  background: rgba(3,5,13,0.92);
  backdrop-filter: blur(10px);
  border-bottom: 1px solid var(--border);
  padding: 0;
}
.ticker-inner {
  display: flex; align-items: center;
  height: 32px;
}
.ticker-label {
  padding: 0 14px; font-size: 10px; font-weight: 700;
  letter-spacing: 1.5px; text-transform: uppercase;
  color: var(--cyan); white-space: nowrap;
  border-right: 1px solid var(--border);
  height: 100%; display: flex; align-items: center;
  background: rgba(0,212,255,0.04);
  flex-shrink: 0;
}
.ticker-scroll { overflow: hidden; flex: 1; }
.ticker-track {
  display: flex; gap: 32px;
  animation: scroll-ticker 35s linear infinite;
  white-space: nowrap;
}
.tk {
  display: flex; align-items: center; gap: 6px;
  font-size: 11px; font-weight: 600;
  font-family: var(--font-mono);
}
.tk-name { color: var(--text2); }
.tk-val { color: var(--cyan); }
.tk-val.red { color: var(--pink); }
.tk-val.grn { color: var(--green); }
.tk-sep { color: var(--border2); }

@keyframes scroll-ticker {
  from { transform: translateX(0); }
  to { transform: translateX(-50%); }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PAGE SYSTEM
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.page { display: none; padding-top: calc(var(--nav-h) + 32px); min-height: 100vh; }
.page.on { display: block; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   HERO â€” HOME PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.hero {
  padding: 60px 0 40px;
  position: relative; overflow: hidden;
}
.hero-content { position: relative; z-index: 2; text-align: center; }

.hero-badge {
  display: inline-flex; align-items: center; gap: 8px;
  background: rgba(0,212,255,0.07);
  border: 1px solid rgba(0,212,255,0.2);
  padding: 8px 18px; border-radius: 100px;
  font-size: 12px; font-weight: 600;
  color: var(--cyan); letter-spacing: 1px;
  text-transform: uppercase; margin-bottom: 32px;
  animation: fade-up 0.6s ease both;
}
.badge-dot {
  width: 6px; height: 6px; background: var(--green);
  border-radius: 50%; animation: blink 1.5s infinite;
}

.hero-h1 {
  font-family: var(--font-display); font-weight: 800;
  font-size: clamp(44px, 8vw, 96px);
  line-height: 0.92; letter-spacing: -3px;
  margin-bottom: 28px;
  animation: fade-up 0.6s 0.1s ease both;
}
.hero-h1 .g1 {
  display: block; color: var(--text);
}
.hero-h1 .g2 {
  display: block;
  background: linear-gradient(90deg, var(--cyan) 0%, var(--green) 50%, var(--purple) 100%);
  -webkit-background-clip: text; -webkit-text-fill-color: transparent;
  background-clip: text;
}
.hero-sub {
  font-size: clamp(15px, 2vw, 19px); color: var(--text2);
  max-width: 560px; margin: 0 auto 44px;
  line-height: 1.65;
  animation: fade-up 0.6s 0.2s ease both;
}
.hero-ctas {
  display: flex; gap: 14px; justify-content: center;
  flex-wrap: wrap; margin-bottom: 64px;
  animation: fade-up 0.6s 0.3s ease both;
}
.cta-primary {
  background: linear-gradient(135deg, var(--cyan), #0055cc);
  color: #fff; border: none;
  padding: 16px 36px; border-radius: 12px;
  font-family: var(--font-display); font-weight: 700;
  font-size: 16px; transition: all 0.25s;
  box-shadow: 0 0 40px rgba(0,212,255,0.3);
  display: flex; align-items: center; gap: 8px;
}
.cta-primary:hover { transform: translateY(-2px); box-shadow: 0 0 60px rgba(0,212,255,0.5); }
.cta-secondary {
  background: rgba(255,255,255,0.04);
  color: var(--text); border: 1px solid var(--border2);
  padding: 16px 36px; border-radius: 12px;
  font-family: var(--font-display); font-weight: 700;
  font-size: 16px; transition: all 0.25s;
  display: flex; align-items: center; gap: 8px;
}
.cta-secondary:hover { border-color: rgba(0,212,255,0.4); background: rgba(0,212,255,0.05); }

/* â”€â”€ STAT CARDS â”€â”€ */
.stats-grid {
  display: grid; grid-template-columns: repeat(4,1fr);
  gap: 1px; background: var(--border);
  border: 1px solid var(--border); border-radius: var(--r2);
  overflow: hidden; margin-bottom: 48px;
  animation: fade-up 0.6s 0.4s ease both;
}
.stat-card {
  background: var(--card); padding: 24px 20px; text-align: center;
  transition: background 0.2s; cursor: default;
}
.stat-card:hover { background: var(--card2); }
.stat-n {
  font-family: var(--font-display); font-weight: 800;
  font-size: 30px; color: var(--cyan);
  display: block; margin-bottom: 4px;
  letter-spacing: -1px;
}
.stat-l {
  font-size: 11px; color: var(--text2);
  text-transform: uppercase; letter-spacing: 1px; font-weight: 600;
}

/* â”€â”€ HOW IT WORKS â”€â”€ */
.section { padding: 80px 0; }
.section-head { text-align: center; margin-bottom: 56px; }
.s-label {
  font-size: 11px; font-weight: 700; letter-spacing: 2px;
  text-transform: uppercase; color: var(--cyan); margin-bottom: 12px;
}
.s-title {
  font-family: var(--font-display); font-weight: 800;
  font-size: clamp(28px, 4vw, 48px);
  letter-spacing: -1.5px; line-height: 1.05;
  margin-bottom: 14px;
}
.s-sub { color: var(--text2); font-size: 16px; max-width: 500px; margin: 0 auto; line-height: 1.6; }

.steps {
  display: grid; grid-template-columns: repeat(3,1fr); gap: 20px;
}
.step {
  background: var(--card); border: 1px solid var(--border);
  border-radius: var(--r2); padding: 32px;
  position: relative; overflow: hidden;
  transition: all 0.3s;
}
.step:hover { border-color: var(--border2); transform: translateY(-4px); box-shadow: 0 20px 60px rgba(0,0,0,0.4); }
.step::before {
  content: ''; position: absolute;
  top: 0; left: 0; right: 0; height: 2px;
  background: linear-gradient(90deg, var(--cyan), var(--purple));
  transform: scaleX(0); transition: transform 0.3s;
  transform-origin: left;
}
.step:hover::before { transform: scaleX(1); }
.step-n {
  font-family: var(--font-mono); font-size: 11px;
  color: var(--text3); margin-bottom: 20px; font-weight: 700;
  letter-spacing: 1px;
}
.step-icon { font-size: 40px; margin-bottom: 16px; display: block; }
.step-title {
  font-family: var(--font-display); font-weight: 700;
  font-size: 20px; margin-bottom: 10px;
}
.step-desc { color: var(--text2); font-size: 14px; line-height: 1.65; }

/* â”€â”€ FEATURES GRID â”€â”€ */
.features { display: grid; grid-template-columns: repeat(2,1fr); gap: 20px; }
.feat {
  background: var(--card); border: 1px solid var(--border);
  border-radius: var(--r2); padding: 28px;
  display: flex; gap: 20px; align-items: flex-start;
  transition: all 0.25s;
}
.feat:hover { border-color: var(--border2); background: var(--card2); }
.feat-icon {
  width: 48px; height: 48px; border-radius: 12px;
  display: flex; align-items: center; justify-content: center;
  font-size: 22px; flex-shrink: 0;
}
.feat-icon.c { background: rgba(0,212,255,0.1); }
.feat-icon.g { background: rgba(0,255,136,0.1); }
.feat-icon.p { background: rgba(157,78,221,0.1); }
.feat-icon.a { background: rgba(255,190,11,0.1); }
.feat-title { font-family: var(--font-display); font-weight: 700; font-size: 17px; margin-bottom: 6px; }
.feat-desc { color: var(--text2); font-size: 13px; line-height: 1.6; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SWAP PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.swap-layout {
  display: grid; grid-template-columns: 480px 1fr; gap: 24px;
  align-items: start; padding: 40px 0 80px;
}
.swap-box {
  background: var(--card); border: 1px solid var(--border);
  border-radius: var(--r3); padding: 28px;
  box-shadow: 0 0 60px rgba(0,0,0,0.5), 0 0 40px var(--glow-c);
  position: sticky; top: calc(var(--nav-h) + 52px);
}
.swap-head {
  display: flex; align-items: center; justify-content: space-between;
  margin-bottom: 22px;
}
.swap-title { font-family: var(--font-display); font-weight: 800; font-size: 20px; }
.icon-btn {
  width: 34px; height: 34px; border-radius: 9px;
  background: var(--card2); border: 1px solid var(--border);
  color: var(--text2); font-size: 15px;
  display: flex; align-items: center; justify-content: center;
  transition: all 0.2s;
}
.icon-btn:hover { border-color: var(--cyan); color: var(--cyan); }

/* Slippage */
.slip-row { display: flex; gap: 6px; align-items: center; margin-bottom: 18px; }
.slip-lbl { font-size: 12px; color: var(--text2); font-weight: 500; }
.slip-btn {
  padding: 5px 11px; border-radius: 7px; font-size: 12px; font-weight: 600;
  background: var(--bg3); border: 1px solid var(--border);
  color: var(--text2); transition: all 0.15s;
}
.slip-btn.on, .slip-btn:hover { border-color: var(--cyan); color: var(--cyan); background: rgba(0,212,255,0.07); }
.slip-input {
  width: 54px; padding: 5px 8px; border-radius: 7px;
  background: var(--bg3); border: 1px solid var(--border);
  color: var(--text); font-size: 12px; text-align: center; outline: none;
}

/* Token input */
.in-label {
  font-size: 12px; color: var(--text2); font-weight: 500;
  display: flex; justify-content: space-between; margin-bottom: 8px;
}
.in-max { color: var(--cyan); cursor: pointer; font-weight: 700; font-size: 11px; }
.in-max:hover { text-decoration: underline; }
.token-in {
  background: var(--bg3); border: 1px solid var(--border);
  border-radius: var(--r); padding: 14px 16px;
  display: flex; align-items: center; gap: 10px;
  transition: border-color 0.2s;
}
.token-in:focus-within { border-color: rgba(0,212,255,0.4); }
.tok-badge {
  display: flex; align-items: center; gap: 7px;
  background: var(--card); border: 1px solid var(--border);
  padding: 8px 12px; border-radius: 9px;
  font-family: var(--font-display); font-weight: 700; font-size: 13px;
  white-space: nowrap; min-width: 108px; flex-shrink: 0;
}
.tok-ic {
  width: 22px; height: 22px; border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-size: 9px; font-weight: 900; flex-shrink: 0;
}
.ic-matic { background: linear-gradient(135deg, #8247e5, #a78bfa); color: #fff; }
.ic-aitk  { background: linear-gradient(135deg, var(--cyan), var(--purple)); color: #fff; }
.amt-in {
  flex: 1; background: transparent; border: none; outline: none;
  color: var(--text); font-family: var(--font-mono);
  font-size: 22px; font-weight: 700; text-align: right; width: 100%;
}
.amt-in::placeholder { color: var(--text3); }

/* Arrow */
.swap-mid { display: flex; justify-content: center; margin: 8px 0; }
.arr-btn {
  width: 38px; height: 38px; border-radius: 10px;
  background: var(--card2); border: 2px solid var(--border);
  color: var(--text2); font-size: 17px;
  display: flex; align-items: center; justify-content: center;
  transition: all 0.25s;
}
.arr-btn:hover { border-color: var(--cyan); color: var(--cyan); transform: rotate(180deg); }

/* Info box */
.info-box {
  background: var(--bg3); border-radius: var(--r);
  padding: 14px 16px; margin: 14px 0; font-size: 13px;
}
.info-row { display: flex; justify-content: space-between; padding: 3px 0; }
.info-row .k { color: var(--text2); }
.info-row .v { font-family: var(--font-mono); font-weight: 600; font-size: 12px; }

/* Status */
.status-box {
  background: var(--bg3); border-radius: var(--r);
  padding: 12px 14px; margin-top: 12px;
  display: flex; align-items: flex-start; gap: 10px; font-size: 13px;
}
.s-dot { width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0; margin-top: 4px; }
.s-dot.spin { animation: blink 0.8s infinite; background: var(--amber); }
.s-dot.ok   { background: var(--green); }
.s-dot.err  { background: var(--pink); }
.s-body { flex: 1; }
.s-msg { font-size: 13px; color: var(--text); }
.s-link { font-family: var(--font-mono); font-size: 11px; color: var(--cyan); margin-top: 3px; display: block; }

/* Main button */
.btn-go {
  width: 100%; padding: 16px; border: none; border-radius: 12px;
  font-family: var(--font-display); font-weight: 800; font-size: 16px;
  cursor: pointer; transition: all 0.22s; margin-top: 10px;
}
.btn-go.primary {
  background: linear-gradient(135deg, var(--cyan), #0055cc);
  color: #fff; box-shadow: 0 0 30px rgba(0,212,255,0.2);
}
.btn-go.primary:hover { transform: translateY(-2px); box-shadow: 0 0 50px rgba(0,212,255,0.4); }
.btn-go.primary:disabled { opacity: 0.45; cursor: not-allowed; transform: none !important; }

/* Right panel â€” market info */
.market-panel { display: flex; flex-direction: column; gap: 16px; }
.m-card {
  background: var(--card); border: 1px solid var(--border);
  border-radius: var(--r2); padding: 22px;
  transition: border-color 0.2s;
}
.m-card:hover { border-color: var(--border2); }
.m-card-title {
  font-family: var(--font-display); font-weight: 700; font-size: 14px;
  color: var(--text2); margin-bottom: 16px;
  text-transform: uppercase; letter-spacing: 0.5px;
}
.m-row { display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid var(--border); }
.m-row:last-child { border-bottom: none; }
.m-k { font-size: 13px; color: var(--text2); }
.m-v { font-family: var(--font-mono); font-size: 13px; font-weight: 600; color: var(--text); }
.m-v.grn { color: var(--green); }
.m-v.cyn { color: var(--cyan); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SERVICES PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.services-page { padding: 40px 0 80px; }
.services-head {
  display: flex; justify-content: space-between;
  align-items: flex-end; margin-bottom: 32px; gap: 16px;
}
.filter-row { display: flex; gap: 8px; flex-wrap: wrap; }
.filter-btn {
  padding: 8px 16px; border-radius: 100px; font-size: 13px; font-weight: 600;
  background: var(--card); border: 1px solid var(--border);
  color: var(--text2); transition: all 0.2s;
}
.filter-btn.on, .filter-btn:hover { border-color: var(--cyan); color: var(--cyan); background: rgba(0,212,255,0.07); }

.svc-grid { display: grid; grid-template-columns: repeat(3,1fr); gap: 18px; }

.svc-card {
  background: var(--card); border: 1px solid var(--border);
  border-radius: var(--r2); overflow: hidden;
  cursor: pointer; transition: all 0.3s;
  display: flex; flex-direction: column;
}
.svc-card:hover {
  border-color: var(--border2);
  transform: translateY(-5px);
  box-shadow: 0 24px 60px rgba(0,0,0,0.5), 0 0 30px var(--glow-c);
}
.svc-banner {
  height: 80px; display: flex; align-items: center;
  justify-content: center; font-size: 36px;
  position: relative; overflow: hidden;
}
.svc-body { padding: 20px; flex: 1; display: flex; flex-direction: column; }
.svc-cat {
  font-size: 10px; font-weight: 700; letter-spacing: 1.5px;
  text-transform: uppercase; margin-bottom: 8px;
}
.svc-name { font-family: var(--font-display); font-weight: 800; font-size: 18px; margin-bottom: 8px; line-height: 1.2; }
.svc-desc { color: var(--text2); font-size: 13px; line-height: 1.6; margin-bottom: 16px; flex: 1; }
.svc-footer { display: flex; align-items: center; justify-content: space-between; }
.svc-price-wrap {}
.svc-price { font-family: var(--font-mono); font-size: 16px; font-weight: 700; color: var(--green); }
.svc-unit { font-size: 10px; color: var(--text3); margin-top: 1px; }
.svc-badge {
  padding: 5px 12px; border-radius: 100px; font-size: 11px; font-weight: 700;
}
.svc-badge.live { background: rgba(0,255,136,0.1); color: var(--green); border: 1px solid rgba(0,255,136,0.2); }
.svc-badge.reg  { background: rgba(0,212,255,0.1); color: var(--cyan); border: 1px solid rgba(0,212,255,0.2); }
.svc-badge.soon { background: rgba(255,190,11,0.1); color: var(--amber); border: 1px solid rgba(255,190,11,0.2); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PORTFOLIO PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.port-page { padding: 40px 0 80px; }
.port-hero {
  background: linear-gradient(135deg, rgba(0,212,255,0.05), rgba(157,78,221,0.05));
  border: 1px solid var(--border); border-radius: var(--r3);
  padding: 36px; margin-bottom: 24px;
  display: grid; grid-template-columns: repeat(3,1fr) 1px repeat(2,1fr); gap: 0;
  position: relative; overflow: hidden;
}
.port-hero::before {
  content: ''; position: absolute;
  top: 0; left: 0; right: 0; height: 2px;
  background: linear-gradient(90deg, var(--cyan), var(--purple), var(--green));
}
.ph-div { background: var(--border); width: 1px; }
.ph-item { padding: 0 32px; }
.ph-item:first-child { padding-left: 0; }
.ph-item:last-child { padding-right: 0; }
.ph-label { font-size: 11px; color: var(--text2); text-transform: uppercase; letter-spacing: 1px; font-weight: 600; margin-bottom: 8px; }
.ph-val { font-family: var(--font-display); font-weight: 800; font-size: 28px; letter-spacing: -1px; }
.ph-sub { font-size: 12px; color: var(--text2); margin-top: 4px; }
.ph-sub.up { color: var(--green); }
.ph-sub.dn { color: var(--pink); }

/* Approve banner */
.approve-banner {
  background: rgba(255,190,11,0.06); border: 1px solid rgba(255,190,11,0.2);
  border-radius: var(--r); padding: 16px 20px;
  display: flex; align-items: center; gap: 14px; margin-bottom: 20px;
}
.approve-banner .ab-icon { font-size: 22px; flex-shrink: 0; }
.approve-banner .ab-text { flex: 1; }
.approve-banner .ab-title { font-weight: 700; font-size: 14px; color: var(--amber); margin-bottom: 2px; }
.approve-banner .ab-sub { font-size: 12px; color: var(--text2); }
.btn-approve {
  background: linear-gradient(135deg, var(--amber), #e67e00);
  color: #000; border: none; padding: 10px 20px; border-radius: 9px;
  font-weight: 700; font-size: 13px; white-space: nowrap; flex-shrink: 0;
}
.btn-approve:hover { filter: brightness(1.1); }

/* TX list */
.panel {
  background: var(--card); border: 1px solid var(--border);
  border-radius: var(--r2); overflow: hidden;
}
.panel-head {
  padding: 18px 22px; border-bottom: 1px solid var(--border);
  display: flex; align-items: center; justify-content: space-between;
}
.panel-title { font-family: var(--font-display); font-weight: 700; font-size: 15px; }
.panel-action {
  background: var(--card2); border: 1px solid var(--border);
  color: var(--text2); padding: 7px 14px; border-radius: 8px;
  font-size: 12px; font-weight: 600; transition: all 0.2s;
}
.panel-action:hover { border-color: var(--cyan); color: var(--cyan); }
.panel-body { padding: 8px 8px; }

.tx-row {
  display: flex; align-items: center; gap: 14px;
  padding: 12px 14px; border-radius: var(--r);
  cursor: pointer; transition: background 0.2s;
}
.tx-row:hover { background: var(--card2); }
.tx-ic {
  width: 40px; height: 40px; border-radius: 11px;
  display: flex; align-items: center; justify-content: center;
  font-size: 18px; flex-shrink: 0;
}
.tx-ic.recv { background: rgba(0,255,136,0.1); }
.tx-ic.send { background: rgba(255,0,110,0.1); }
.tx-ic.pay  { background: rgba(0,212,255,0.1); }
.tx-info { flex: 1; min-width: 0; }
.tx-name { font-family: var(--font-display); font-weight: 700; font-size: 14px; }
.tx-hash { font-family: var(--font-mono); font-size: 10px; color: var(--text3); margin-top: 2px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.tx-right { text-align: right; }
.tx-amt { font-family: var(--font-mono); font-weight: 700; font-size: 13px; }
.tx-amt.pos { color: var(--green); }
.tx-amt.neg { color: var(--pink); }
.tx-date { font-size: 11px; color: var(--text3); margin-top: 2px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CONTRACTS PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.contracts-page { padding: 40px 0 80px; }
.ctr-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 24px; }
.ctr-card {
  background: var(--card); border: 1px solid var(--border);
  border-radius: var(--r2); padding: 26px;
  position: relative; overflow: hidden;
}
.ctr-stripe {
  position: absolute; top: 0; left: 0; right: 0; height: 3px;
}
.ctr-card.tok .ctr-stripe { background: linear-gradient(90deg, var(--cyan), transparent); }
.ctr-card.rtr .ctr-stripe { background: linear-gradient(90deg, var(--purple), transparent); }
.ctr-type { font-size: 10px; font-weight: 700; letter-spacing: 1.5px; text-transform: uppercase; margin-bottom: 10px; }
.ctr-card.tok .ctr-type { color: var(--cyan); }
.ctr-card.rtr .ctr-type { color: #c084fc; }
.ctr-name { font-family: var(--font-display); font-weight: 800; font-size: 20px; margin-bottom: 16px; }
.addr-row {
  background: var(--bg2); border: 1px solid var(--border);
  border-radius: var(--r); padding: 11px 14px;
  display: flex; align-items: center; gap: 10px;
}
.addr-txt {
  font-family: var(--font-mono); font-size: 11px;
  color: var(--text2); flex: 1; overflow: hidden;
  text-overflow: ellipsis; white-space: nowrap;
}
.copy-btn {
  background: var(--card2); border: 1px solid var(--border);
  color: var(--text2); padding: 5px 12px; border-radius: 7px;
  font-size: 11px; font-weight: 600; transition: all 0.2s; white-space: nowrap;
}
.copy-btn:hover { border-color: var(--cyan); color: var(--cyan); }
.ctr-tags { display: flex; gap: 7px; margin-top: 12px; flex-wrap: wrap; }
.tag {
  padding: 4px 10px; border-radius: 100px;
  font-size: 11px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;
}
.tag.c { background: rgba(0,212,255,0.1); border: 1px solid rgba(0,212,255,0.2); color: var(--cyan); }
.tag.g { background: rgba(0,255,136,0.1); border: 1px solid rgba(0,255,136,0.2); color: var(--green); }
.tag.p { background: rgba(157,78,221,0.15); border: 1px solid rgba(157,78,221,0.3); color: #c084fc; }
.tag.a { background: rgba(255,190,11,0.1); border: 1px solid rgba(255,190,11,0.25); color: var(--amber); }
.ctr-links { display: flex; gap: 14px; margin-top: 14px; }
.ctr-link { font-size: 12px; font-weight: 600; text-decoration: none; color: var(--cyan); transition: opacity 0.2s; }
.ctr-link:hover { opacity: 0.7; }
.ctr-link.p { color: #c084fc; }

/* Live reads panel */
.reads-grid { display: grid; grid-template-columns: repeat(2,1fr); gap: 14px; }
.read-card {
  background: var(--card); border: 1px solid var(--border);
  border-radius: var(--r); padding: 18px;
}
.read-type { font-size: 10px; font-weight: 700; letter-spacing: 1px; text-transform: uppercase; color: var(--green); margin-bottom: 7px; }
.read-fn { font-family: var(--font-mono); font-size: 13px; font-weight: 700; margin-bottom: 5px; color: var(--text); }
.read-desc { font-size: 12px; color: var(--text2); line-height: 1.5; margin-bottom: 12px; }
.read-val {
  background: var(--bg2); border-radius: 8px; padding: 10px 12px;
  font-family: var(--font-mono); font-size: 12px;
  color: var(--green); word-break: break-all; min-height: 38px;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MODALS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.overlay {
  position: fixed; inset: 0;
  background: rgba(3,5,13,0.92);
  backdrop-filter: blur(12px);
  z-index: 500;
  display: flex; align-items: center; justify-content: center;
  opacity: 0; visibility: hidden; transition: all 0.25s;
  padding: 20px;
}
.overlay.on { opacity: 1; visibility: visible; }

.modal {
  background: var(--card); border: 1px solid var(--border2);
  border-radius: var(--r3); padding: 0;
  width: 100%; max-width: 480px;
  max-height: 90vh; overflow-y: auto;
  transform: scale(0.94) translateY(10px);
  transition: transform 0.25s;
  position: relative;
  box-shadow: 0 40px 120px rgba(0,0,0,0.7), 0 0 60px var(--glow-c);
}
.overlay.on .modal { transform: scale(1) translateY(0); }
.modal-stripe {
  height: 3px; border-radius: var(--r3) var(--r3) 0 0;
  background: linear-gradient(90deg, var(--cyan), var(--purple), var(--green));
}
.modal-inner { padding: 28px; }
.modal-close {
  position: absolute; top: 18px; right: 18px;
  width: 30px; height: 30px; border-radius: 8px;
  background: var(--card2); border: 1px solid var(--border);
  color: var(--text2); font-size: 14px;
  display: flex; align-items: center; justify-content: center;
  transition: all 0.2s; z-index: 1;
}
.modal-close:hover { border-color: var(--pink); color: var(--pink); }
.m-title { font-family: var(--font-display); font-weight: 800; font-size: 22px; margin-bottom: 4px; }
.m-sub { color: var(--text2); font-size: 13px; margin-bottom: 24px; line-height: 1.5; }

/* Wallet options */
.w-opts { display: flex; flex-direction: column; gap: 10px; }
.w-opt {
  background: var(--bg3); border: 1px solid var(--border);
  border-radius: var(--r); padding: 15px 18px;
  display: flex; align-items: center; gap: 14px;
  cursor: pointer; transition: all 0.2s;
}
.w-opt:hover { border-color: var(--border2); background: rgba(0,212,255,0.04); transform: translateX(3px); }
.w-opt.featured { border-color: rgba(0,212,255,0.25); background: rgba(0,212,255,0.04); }
.w-ic {
  width: 44px; height: 44px; border-radius: 11px;
  font-size: 24px; display: flex; align-items: center; justify-content: center;
  flex-shrink: 0;
}
.w-name { font-family: var(--font-display); font-weight: 700; font-size: 15px; }
.w-desc { font-size: 12px; color: var(--text2); margin-top: 2px; }
.w-badge {
  margin-left: auto; padding: 4px 10px; border-radius: 100px;
  font-size: 10px; font-weight: 700; letter-spacing: 0.5px;
  background: rgba(0,255,136,0.1); color: var(--green);
  border: 1px solid rgba(0,255,136,0.2); white-space: nowrap; flex-shrink: 0;
}

/* QR section */
.qr-section { text-align: center; }
.qr-box {
  background: var(--bg3); border: 1px solid var(--border2);
  border-radius: var(--r2); padding: 24px;
  margin-bottom: 16px;
}
.qr-img-wrap {
  background: #fff; padding: 12px; border-radius: 12px;
  display: inline-block; margin-bottom: 14px;
}
.qr-wallets { display: flex; gap: 8px; justify-content: center; flex-wrap: wrap; margin-bottom: 16px; }
.qr-w {
  padding: 5px 12px; border-radius: 100px;
  font-size: 11px; font-weight: 600;
  background: rgba(0,212,255,0.07);
  border: 1px solid rgba(0,212,255,0.15); color: var(--cyan);
}
.back-btn {
  background: none; border: 1px solid var(--border);
  color: var(--text2); padding: 9px 18px; border-radius: 9px;
  font-size: 13px; transition: all 0.2s; margin-top: 8px;
}
.back-btn:hover { border-color: var(--cyan); color: var(--cyan); }

/* Pay modal */
.fee-box {
  background: var(--bg3); border-radius: var(--r);
  padding: 14px 16px; margin: 14px 0;
}
.form-field { margin-bottom: 14px; }
.f-label {
  display: block; font-size: 12px; color: var(--text2);
  font-weight: 600; margin-bottom: 7px;
  text-transform: uppercase; letter-spacing: 0.8px;
}
.f-input, .f-textarea {
  width: 100%; background: var(--bg3); border: 1px solid var(--border);
  border-radius: var(--r); padding: 12px 14px; color: var(--text);
  font-size: 14px; outline: none; transition: border-color 0.2s;
}
.f-input:focus, .f-textarea:focus { border-color: rgba(0,212,255,0.4); }
.f-textarea { resize: vertical; min-height: 70px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TOAST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.toast-stack {
  position: fixed; bottom: 24px; right: 24px;
  z-index: 9999; display: flex; flex-direction: column; gap: 10px;
  max-width: 360px;
}
.toast {
  background: var(--card); border-radius: var(--r);
  padding: 14px 18px; display: flex; align-items: flex-start; gap: 12px;
  box-shadow: 0 8px 40px rgba(0,0,0,0.5);
  transform: translateX(120%); transition: transform 0.35s cubic-bezier(0.34,1.56,0.64,1);
  pointer-events: none;
}
.toast.in {
  transform: translateX(0); pointer-events: auto;
}
.toast.ok  { border: 1px solid rgba(0,255,136,0.3); }
.toast.err { border: 1px solid rgba(255,0,110,0.3); }
.toast.inf { border: 1px solid rgba(0,212,255,0.2); }
.t-icon { font-size: 18px; flex-shrink: 0; margin-top: 1px; }
.t-title { font-weight: 700; font-size: 13px; }
.t-msg { font-size: 12px; color: var(--text2); margin-top: 2px; line-height: 1.4; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FOOTER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.footer {
  background: var(--bg2); border-top: 1px solid var(--border);
  padding: 48px 0 28px; position: relative; z-index: 2;
}
.footer-grid { display: grid; grid-template-columns: 2fr 1fr 1fr 1fr; gap: 48px; margin-bottom: 40px; }
.footer-brand p { color: var(--text2); font-size: 14px; line-height: 1.7; margin: 14px 0 20px; max-width: 260px; }
.social-row { display: flex; gap: 10px; }
.soc-btn {
  width: 36px; height: 36px; border-radius: 9px;
  background: var(--card); border: 1px solid var(--border);
  display: flex; align-items: center; justify-content: center;
  font-size: 15px; transition: all 0.2s;
}
.soc-btn:hover { border-color: var(--cyan); }
.footer-col h4 {
  font-size: 12px; font-weight: 700; text-transform: uppercase;
  letter-spacing: 1.5px; color: var(--text2); margin-bottom: 16px;
}
.footer-col ul { list-style: none; display: flex; flex-direction: column; gap: 10px; }
.footer-col a { color: var(--text2); font-size: 14px; transition: color 0.2s; }
.footer-col a:hover { color: var(--text); }
.footer-bottom {
  border-top: 1px solid var(--border); padding-top: 24px;
  display: flex; justify-content: space-between; align-items: center;
}
.footer-bottom p { font-size: 13px; color: var(--text3); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ANIMATIONS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@keyframes shake {
  0%, 100% { transform: translateX(0); }
  20% { transform: translateX(-8px); }
  40% { transform: translateX(8px); }
  60% { transform: translateX(-5px); }
  80% { transform: translateX(5px); }
}
@keyframes fade-up {
  from { opacity: 0; transform: translateY(20px); }
  to   { opacity: 1; transform: translateY(0); }
}
@keyframes blink {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.3; }
}
@keyframes spin {
  to { transform: rotate(360deg); }
}
.spinner {
  display: inline-block; width: 14px; height: 14px;
  border: 2px solid rgba(255,255,255,0.2);
  border-top-color: #fff; border-radius: 50%;
  animation: spin 0.7s linear infinite;
  vertical-align: middle; margin-right: 6px;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RESPONSIVE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@media (max-width: 1024px) {
  .swap-layout { grid-template-columns: 1fr; }
  .swap-box { position: static; }
  .footer-grid { grid-template-columns: 1fr 1fr; }
  .port-hero { grid-template-columns: 1fr 1fr; gap: 24px; }
  .ph-div { display: none; }
  .ph-item { padding: 0; }
}
@media (max-width: 768px) {
  .stats-grid { grid-template-columns: 1fr 1fr; }
  .steps { grid-template-columns: 1fr; }
  .features { grid-template-columns: 1fr; }
  .svc-grid { grid-template-columns: 1fr 1fr; }
  .ctr-grid { grid-template-columns: 1fr; }
  .reads-grid { grid-template-columns: 1fr; }
  .footer-grid { grid-template-columns: 1fr 1fr; }
  .port-hero { grid-template-columns: 1fr; }
  .hero-h1 { letter-spacing: -2px; }
  .nav-tabs { display: none; }
  .mobile-nav { display: flex !important; }
}
@media (max-width: 480px) {
  .svc-grid { grid-template-columns: 1fr; }
  .footer-grid { grid-template-columns: 1fr; }
  .hero-ctas { flex-direction: column; }
  .cta-primary, .cta-secondary { justify-content: center; }
  .stats-grid { grid-template-columns: 1fr 1fr; }
}

/* Mobile bottom nav */
.mobile-nav {
  display: none; position: fixed; bottom: 0; left: 0; right: 0;
  z-index: 200; background: rgba(3,5,13,0.95);
  backdrop-filter: blur(20px);
  border-top: 1px solid var(--border);
  padding: 8px 0 calc(8px + env(safe-area-inset-bottom));
}
.mob-tabs { display: flex; justify-content: space-around; }
.mob-tab {
  display: flex; flex-direction: column; align-items: center; gap: 3px;
  padding: 6px 16px; border: none; background: none;
  color: var(--text2); font-size: 10px; font-weight: 600;
  transition: color 0.2s;
}
.mob-tab.on { color: var(--cyan); }
.mob-tab .mi { font-size: 20px; }
</style>
</head>
<body>

<!-- Animated background -->
<canvas id="bg-canvas"></canvas>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• NAV â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<nav class="z1">
  <div class="wrap nav-wrap">
    <a href="#" class="logo" onclick="showPage('home')">
      <div class="logo-icon">AI</div>
      <span class="logo-name">AITK<em>.</em></span>
    </a>

    <div class="nav-tabs">
      <button class="ntab on" onclick="showPage('home',this)"><span class="ti">âŒ‚</span> Home</button>
      <button class="ntab" onclick="showPage('swap',this)"><span class="ti">â‡„</span> Swap</button>
      <button class="ntab" onclick="showPage('services',this)"><span class="ti">ğŸ¤–</span> AI Services</button>
      <button class="ntab" onclick="showPage('portfolio',this)"><span class="ti">ğŸ’¼</span> Portfolio</button>
      <button class="ntab" onclick="showPage('contracts',this)"><span class="ti">ğŸ“„</span> Contracts</button>
    </div>

    <div class="nav-right">
      <div class="net-pill" id="net-pill" style="display:none;">
        <span class="dot"></span>
        <span id="net-lbl">Polygon</span>
      </div>
      <button class="btn-connect" id="btn-connect" onclick="openOverlay('wallet-overlay')">Connect Wallet</button>
      <div class="wallet-chip" id="wallet-chip" style="display:none;" onclick="openOverlay('info-overlay')">
        <span class="w-dot"></span>
        <span id="chip-addr">0xâ€¦</span>
      </div>
    </div>
  </div>
</nav>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TICKER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="ticker-bar z1">
  <div class="ticker-inner">
    <div class="ticker-label">LIVE</div>
    <div class="ticker-scroll">
      <div class="ticker-track" id="ticker">
        <span class="tk"><span class="tk-name">AITK/USD</span><span class="tk-val" id="tk-price">â€”</span></span>
        <span class="tk-sep">Â·</span>
        <span class="tk"><span class="tk-name">MATIC/USD</span><span class="tk-val grn" id="tk-matic">â€”</span></span>
        <span class="tk-sep">Â·</span>
        <span class="tk"><span class="tk-name">PLATFORM FEE</span><span class="tk-val" id="tk-fee">â€”</span></span>
        <span class="tk-sep">Â·</span>
        <span class="tk"><span class="tk-name">FEES COLLECTED</span><span class="tk-val grn" id="tk-acc">â€”</span></span>
        <span class="tk-sep">Â·</span>
        <span class="tk"><span class="tk-name">NETWORK</span><span class="tk-val">Polygon 137</span></span>
        <span class="tk-sep">Â·</span>
        <span class="tk"><span class="tk-name">BLOCK</span><span class="tk-val" id="tk-block">â€”</span></span>
        <span class="tk-sep">Â·</span>
        <!-- duplicate for seamless loop -->
        <span class="tk"><span class="tk-name">AITK/USD</span><span class="tk-val" id="tk-price2">â€”</span></span>
        <span class="tk-sep">Â·</span>
        <span class="tk"><span class="tk-name">MATIC/USD</span><span class="tk-val grn" id="tk-matic2">â€”</span></span>
        <span class="tk-sep">Â·</span>
        <span class="tk"><span class="tk-name">PLATFORM FEE</span><span class="tk-val" id="tk-fee2">â€”</span></span>
        <span class="tk-sep">Â·</span>
        <span class="tk"><span class="tk-name">FEES COLLECTED</span><span class="tk-val grn" id="tk-acc2">â€”</span></span>
        <span class="tk-sep">Â·</span>
        <span class="tk"><span class="tk-name">NETWORK</span><span class="tk-val">Polygon 137</span></span>
        <span class="tk-sep">Â·</span>
        <span class="tk"><span class="tk-name">BLOCK</span><span class="tk-val" id="tk-block2">â€”</span></span>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     HOME PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="page on z1" id="page-home">
  <div class="wrap">
    <div class="hero">
      <div class="hero-content">
        <div class="hero-badge"><span class="badge-dot"></span> Live on Polygon Mainnet</div>
        <h1 class="hero-h1">
          <span class="g1">The Currency of</span>
          <span class="g2">Artificial Intelligence</span>
        </h1>
        <p class="hero-sub">
          Buy, sell, and pay for AI models, LLMs, GPU compute, and intelligent services
          with AITK â€” the native token powering the decentralized AI economy on Polygon.
        </p>
        <div class="hero-ctas">
          <button class="cta-primary" onclick="showPage('swap')">â‡„ Start Swapping</button>
          <button class="cta-secondary" onclick="showPage('services')">ğŸ¤– Explore AI Services</button>
        </div>

        <!-- Stats -->
        <div class="stats-grid">
          <div class="stat-card">
            <span class="stat-n" id="h-price">â€”</span>
            <span class="stat-l">AITK Price</span>
          </div>
          <div class="stat-card">
            <span class="stat-n" id="h-matic">â€”</span>
            <span class="stat-l">MATIC / USD</span>
          </div>
          <div class="stat-card">
            <span class="stat-n" id="h-supply">â€”</span>
            <span class="stat-l">Total Supply</span>
          </div>
          <div class="stat-card">
            <span class="stat-n" id="h-block">â€”</span>
            <span class="stat-l">Latest Block</span>
          </div>
        </div>
      </div>
    </div>

    <!-- How it works -->
    <div class="section">
      <div class="section-head">
        <div class="s-label">Simple by Design</div>
        <h2 class="s-title">Three Steps to the<br>AI Economy</h2>
        <p class="s-sub">Get AITK and start paying for AI services in minutes, not days.</p>
      </div>
      <div class="steps">
        <div class="step">
          <div class="step-n">STEP 01</div>
          <span class="step-icon">ğŸ”—</span>
          <div class="step-title">Connect Your Wallet</div>
          <div class="step-desc">Use WalletConnect to connect from any mobile wallet â€” Trust Wallet, MetaMask Mobile, Rainbow, and more. No app download required.</div>
        </div>
        <div class="step">
          <div class="step-n">STEP 02</div>
          <span class="step-icon">â‡„</span>
          <div class="step-title">Get AITK Tokens</div>
          <div class="step-desc">Swap MATIC for AITK instantly via QuickSwap. The payment router handles everything â€” just enter an amount and confirm.</div>
        </div>
        <div class="step">
          <div class="step-n">STEP 03</div>
          <span class="step-icon">ğŸ¤–</span>
          <div class="step-title">Pay for AI Services</div>
          <div class="step-desc">Browse the AI marketplace and pay for LLM API credits, GPU compute, image generation, and more directly on-chain with AITK.</div>
        </div>
      </div>
    </div>

    <!-- Features -->
    <div class="section" style="padding-top:0;">
      <div class="section-head">
        <div class="s-label">Why AITK</div>
        <h2 class="s-title">Built for the<br>AI Age</h2>
      </div>
      <div class="features">
        <div class="feat">
          <div class="feat-icon c">âš¡</div>
          <div>
            <div class="feat-title">Instant Settlement</div>
            <div class="feat-desc">Every payment settles in ~2 seconds on Polygon. No waiting, no bank delays â€” AI services are paid and activated instantly on-chain.</div>
          </div>
        </div>
        <div class="feat">
          <div class="feat-icon g">ğŸ”’</div>
          <div>
            <div class="feat-title">Non-Custodial</div>
            <div class="feat-desc">Your AITK stays in your wallet until the moment you spend it. No platform holds your funds â€” the smart contract handles everything.</div>
          </div>
        </div>
        <div class="feat">
          <div class="feat-icon p">ğŸŒ</div>
          <div>
            <div class="feat-title">Borderless Access</div>
            <div class="feat-desc">Anyone with a wallet can access AI services. No KYC, no bank account, no geographic restrictions â€” truly global AI commerce.</div>
          </div>
        </div>
        <div class="feat">
          <div class="feat-icon a">ğŸ“Š</div>
          <div>
            <div class="feat-title">Full Transparency</div>
            <div class="feat-desc">Every payment, fee, and provider transaction is recorded permanently on Polygon. Verify any transaction on PolygonScan instantly.</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     SWAP PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="page z1" id="page-swap">
  <div class="wrap">
    <div class="swap-layout">

      <!-- Swap box -->
      <div class="swap-box">
        <div class="swap-head">
          <span class="swap-title">Swap Tokens</span>
          <div style="display:flex;gap:6px;">
            <button class="icon-btn" onclick="refreshAll()" title="Refresh">â†»</button>
          </div>
        </div>

        <div class="slip-row">
          <span class="slip-lbl">Slippage:</span>
          <button class="slip-btn on" onclick="setSlip(0.5,this)">0.5%</button>
          <button class="slip-btn" onclick="setSlip(1,this)">1%</button>
          <button class="slip-btn" onclick="setSlip(2,this)">2%</button>
          <input class="slip-input" id="slip-custom" type="number" placeholder="%" min="0.1" max="49" oninput="setSlip(parseFloat(this.value)||0.5,null,true)">
        </div>

        <div class="in-label">
          <span>You pay</span>
          <span id="from-bal">Balance: â€”</span>
        </div>
        <div class="token-in" id="from-box">
          <div class="tok-badge">
            <div class="tok-ic ic-matic">â¬Ÿ</div>
            <span>MATIC</span>
          </div>
          <input class="amt-in" id="from-amt" type="number" placeholder="0.00" oninput="calcOut()">
        </div>

        <div class="swap-mid">
          <button class="arr-btn" title="Flip">â‡…</button>
        </div>

        <div class="in-label" style="margin-top:6px;">
          <span>You receive (estimated)</span>
          <span id="to-bal">Balance: â€”</span>
        </div>
        <div class="token-in">
          <div class="tok-badge">
            <div class="tok-ic ic-aitk">AI</div>
            <span>AITK</span>
          </div>
          <input class="amt-in" id="to-amt" readonly placeholder="0.00">
        </div>

        <div class="info-box" id="swap-info" style="display:none;">
          <div class="info-row"><span class="k">Rate</span><span class="v" id="rate-v">â€”</span></div>
          <div class="info-row"><span class="k">Platform Fee</span><span class="v" id="fee-v">â€”</span></div>
          <div class="info-row"><span class="k">Slippage</span><span class="v" id="slip-v">0.5%</span></div>
          <div class="info-row"><span class="k">Min. Received</span><span class="v" id="min-v">â€”</span></div>
          <div class="info-row"><span class="k">Est. Gas</span><span class="v" style="color:var(--green);">~$0.001</span></div>
        </div>

        <div class="status-box" id="swap-status" style="display:none;">
          <span class="s-dot spin" id="sw-dot"></span>
          <div class="s-body">
            <div class="s-msg" id="sw-msg">Processingâ€¦</div>
            <a class="s-link" id="sw-link" href="#" target="_blank" style="display:none;">View on PolygonScan â†—</a>
          </div>
        </div>

        <button class="btn-go primary" id="swap-btn" onclick="handleSwap()">Connect Wallet to Swap</button>
        <p style="text-align:center;font-size:11px;color:var(--text3);margin-top:10px;">
          Router: <a href="https://polygonscan.com/address/0x792668a0E8De5B7B07A3cfffFeD82cDdEF6738A8" target="_blank" style="color:var(--cyan);font-family:var(--font-mono);font-size:10px;">0x7926â€¦38A8</a>
        </p>
      </div>

      <!-- Market panel -->
      <div class="market-panel">
        <div class="m-card">
          <div class="m-card-title">Market Data</div>
          <div class="m-row"><span class="m-k">AITK Price</span><span class="m-v cyn" id="mp-price">â€”</span></div>
          <div class="m-row"><span class="m-k">MATIC / USD</span><span class="m-v" id="mp-matic">â€”</span></div>
          <div class="m-row"><span class="m-k">Platform Fee</span><span class="m-v" id="mp-fee">â€”</span></div>
          <div class="m-row"><span class="m-k">Fees Collected</span><span class="m-v grn" id="mp-acc">â€”</span></div>
          <div class="m-row"><span class="m-k">Total Supply</span><span class="m-v" id="mp-supply">â€”</span></div>
          <div class="m-row"><span class="m-k">Network</span><span class="m-v">Polygon (137)</span></div>
        </div>

        <div class="m-card">
          <div class="m-card-title">Your Balances</div>
          <div class="m-row"><span class="m-k">AITK</span><span class="m-v cyn" id="mp-aitk">â€”</span></div>
          <div class="m-row"><span class="m-k">MATIC</span><span class="m-v" id="mp-mbal">â€”</span></div>
          <div class="m-row"><span class="m-k">Allowance</span><span class="m-v grn" id="mp-allow">â€”</span></div>
          <div class="m-row"><span class="m-k">Wallet</span><span class="m-v" id="mp-wallet" style="font-family:var(--font-mono);font-size:11px;">Not connected</span></div>
        </div>

        <div class="m-card" style="background:rgba(0,212,255,0.03);border-color:rgba(0,212,255,0.15);">
          <div class="m-card-title">How to Swap</div>
          <div style="color:var(--text2);font-size:13px;line-height:1.8;">
            <div>1ï¸âƒ£ Connect your wallet above</div>
            <div>2ï¸âƒ£ Enter MATIC amount to swap</div>
            <div>3ï¸âƒ£ Click Swap â†’ Opens QuickSwap</div>
            <div>4ï¸âƒ£ Confirm swap to get AITK</div>
            <div>5ï¸âƒ£ Return here to pay for AI services</div>
          </div>
          <a href="https://quickswap.exchange/#/swap?outputCurrency=0x6f9a52d1Bef12a602a9cE943E3eA95c5BbCB9B3d" target="_blank" style="display:block;margin-top:14px;background:rgba(0,212,255,0.1);border:1px solid rgba(0,212,255,0.2);color:var(--cyan);padding:12px;border-radius:10px;text-align:center;font-weight:700;font-size:13px;text-decoration:none;transition:all 0.2s;" onmouseover="this.style.background='rgba(0,212,255,0.15)'" onmouseout="this.style.background='rgba(0,212,255,0.1)'">
            Open QuickSwap â†—
          </a>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     SERVICES PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="page z1" id="page-services">
  <div class="wrap services-page">
    <div class="services-head">
      <div>
        <div class="s-label">AI Marketplace</div>
        <h2 class="s-title" style="margin-bottom:0;">AI Services</h2>
      </div>
      <div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap;">
        <div class="filter-row">
          <button class="filter-btn on" onclick="filterSvc('all',this)">All</button>
          <button class="filter-btn" onclick="filterSvc('llm',this)">LLMs</button>
          <button class="filter-btn" onclick="filterSvc('compute',this)">Compute</button>
          <button class="filter-btn" onclick="filterSvc('gen',this)">Generation</button>
        </div>
        <button onclick="openOverlay('register-overlay')" style="background:var(--card);border:1px solid var(--border2);color:var(--cyan);padding:10px 18px;border-radius:10px;font-weight:700;font-size:13px;transition:all 0.2s;" onmouseover="this.style.background='rgba(0,212,255,0.07)'" onmouseout="this.style.background='var(--card)'">+ Register</button>
      </div>
    </div>

    <div class="svc-grid" id="svc-grid">
      <!-- Rendered by JS -->
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     PORTFOLIO PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="page z1" id="page-portfolio">
  <div class="wrap port-page">
    <div class="s-label">Your Wallet</div>
    <h2 class="s-title" style="margin-bottom:24px;">Portfolio</h2>

    <div class="port-hero" id="port-hero">
      <div class="ph-item">
        <div class="ph-label">AITK Balance</div>
        <div class="ph-val" id="ph-aitk">â€”</div>
        <div class="ph-sub" id="ph-aitk-usd">Connect wallet</div>
      </div>
      <div class="ph-div"></div>
      <div class="ph-item">
        <div class="ph-label">MATIC Balance</div>
        <div class="ph-val" id="ph-matic">â€”</div>
        <div class="ph-sub" id="ph-matic-usd">Connect wallet</div>
      </div>
      <div class="ph-div"></div>
      <div class="ph-item">
        <div class="ph-label">Router Allowance</div>
        <div class="ph-val" id="ph-allow">â€”</div>
        <div class="ph-sub">AITK approved</div>
      </div>
      <div class="ph-item">
        <div class="ph-label">Network</div>
        <div class="ph-val" id="ph-net" style="font-size:16px;">â€”</div>
        <div class="ph-sub" id="ph-block">Block: â€”</div>
      </div>
      <div class="ph-item">
        <div class="ph-label">Wallet</div>
        <div class="ph-val" id="ph-wallet" style="font-size:14px;font-family:var(--font-mono);">â€”</div>
        <div class="ph-sub">Connected address</div>
      </div>
    </div>

    <!-- Approve banner -->
    <div class="approve-banner" id="approve-banner" style="display:none;">
      <div class="ab-icon">âš ï¸</div>
      <div class="ab-text">
        <div class="ab-title">Approve Router to Pay for Services</div>
        <div class="ab-sub">One-time approval â€” lets the router spend AITK when you pay for services</div>
      </div>
      <button class="btn-approve" onclick="approveMax()" id="approve-btn">Approve Now</button>
    </div>

    <!-- TX History -->
    <div class="panel">
      <div class="panel-head">
        <span class="panel-title">Transaction History</span>
        <button class="panel-action" onclick="loadTxHistory()">â†» Refresh</button>
      </div>
      <div class="panel-body" id="tx-list">
        <div style="text-align:center;padding:48px;color:var(--text2);">
          <div style="font-size:44px;margin-bottom:14px;opacity:0.3;">ğŸ”—</div>
          <div style="font-family:var(--font-display);font-weight:700;font-size:18px;margin-bottom:8px;">Connect Your Wallet</div>
          <div style="font-size:14px;margin-bottom:20px;">View your AITK transaction history on Polygon</div>
          <button class="btn-go primary" style="width:auto;padding:12px 32px;" onclick="openOverlay('wallet-overlay')">Connect Wallet</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     CONTRACTS PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="page z1" id="page-contracts">
  <div class="wrap contracts-page">
    <div class="s-label">On-Chain Transparency</div>
    <h2 class="s-title" style="margin-bottom:8px;">Smart Contracts</h2>
    <p style="color:var(--text2);font-size:15px;margin-bottom:32px;">All contract interactions are public and verifiable on Polygon Mainnet.</p>

    <div class="ctr-grid">
      <div class="ctr-card tok">
        <div class="ctr-stripe"></div>
        <div class="ctr-type">ERC-20 Token</div>
        <div class="ctr-name">AITK Token</div>
        <div class="addr-row">
          <span class="addr-txt">0x6f9a52d1Bef12a602a9cE943E3eA95c5BbCB9B3d</span>
          <button class="copy-btn" onclick="copyTxt('0x6f9a52d1Bef12a602a9cE943E3eA95c5BbCB9B3d',this)">Copy</button>
        </div>
        <div class="ctr-tags">
          <span class="tag c">Polygon</span>
          <span class="tag g">ERC-20</span>
          <span class="tag a">Chain 137</span>
        </div>
        <div style="margin-top:14px;background:var(--bg2);border:1px solid var(--border);border-radius:var(--r);padding:12px 14px;">
          <div style="font-size:11px;color:var(--text2);margin-bottom:4px;">Total Supply</div>
          <div style="font-family:var(--font-mono);font-weight:700;color:var(--green);" id="ctr-supply">Loadingâ€¦</div>
        </div>
        <div class="ctr-links">
          <a href="https://polygonscan.com/token/0x6f9a52d1Bef12a602a9cE943E3eA95c5BbCB9B3d" target="_blank" class="ctr-link">PolygonScan â†—</a>
          <button onclick="addToMM()" style="background:none;border:none;color:var(--text2);font-size:12px;font-weight:600;cursor:pointer;transition:color 0.2s;" onmouseover="this.style.color='var(--text)'" onmouseout="this.style.color='var(--text2)'">+ Add to Wallet</button>
        </div>
      </div>

      <div class="ctr-card rtr">
        <div class="ctr-stripe"></div>
        <div class="ctr-type">Payment Router</div>
        <div class="ctr-name">AITK Payment Router</div>
        <div class="addr-row">
          <span class="addr-txt">0x792668a0E8De5B7B07A3cfffFeD82cDdEF6738A8</span>
          <button class="copy-btn" onclick="copyTxt('0x792668a0E8De5B7B07A3cfffFeD82cDdEF6738A8',this)">Copy</button>
        </div>
        <div class="ctr-tags">
          <span class="tag p">Router</span>
          <span class="tag g">Live</span>
          <span class="tag c">payOnChain()</span>
        </div>
        <div style="margin-top:14px;display:grid;grid-template-columns:1fr 1fr;gap:10px;">
          <div style="background:var(--bg2);border:1px solid var(--border);border-radius:var(--r);padding:12px;">
            <div style="font-size:11px;color:var(--text2);margin-bottom:4px;">Platform Fee</div>
            <div style="font-family:var(--font-mono);font-weight:700;color:var(--cyan);" id="ctr-fee">Loadingâ€¦</div>
          </div>
          <div style="background:var(--bg2);border:1px solid var(--border);border-radius:var(--r);padding:12px;">
            <div style="font-size:11px;color:var(--text2);margin-bottom:4px;">Fees Collected</div>
            <div style="font-family:var(--font-mono);font-weight:700;color:var(--green);" id="ctr-acc">Loadingâ€¦</div>
          </div>
        </div>
        <div class="ctr-links">
          <a href="https://polygonscan.com/address/0x792668a0E8De5B7B07A3cfffFeD82cDdEF6738A8" target="_blank" class="ctr-link p">PolygonScan â†—</a>
        </div>
      </div>
    </div>

    <!-- Live reads -->
    <div class="panel">
      <div class="panel-head">
        <span class="panel-title">Live Contract Data</span>
        <button class="panel-action" onclick="readContract()">â†» Refresh</button>
      </div>
      <div class="panel-body" style="padding:16px;">
        <div class="reads-grid" id="reads-grid">
          <!-- Rendered by JS -->
        </div>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     MOBILE BOTTOM NAV
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="mobile-nav z1">
  <div class="mob-tabs">
    <button class="mob-tab on" onclick="showPage('home',this,'mob')"><span class="mi">âŒ‚</span>Home</button>
    <button class="mob-tab" onclick="showPage('swap',this,'mob')"><span class="mi">â‡„</span>Swap</button>
    <button class="mob-tab" onclick="showPage('services',this,'mob')"><span class="mi">ğŸ¤–</span>AI</button>
    <button class="mob-tab" onclick="showPage('portfolio',this,'mob')"><span class="mi">ğŸ’¼</span>Portfolio</button>
    <button class="mob-tab" onclick="showPage('contracts',this,'mob')"><span class="mi">ğŸ“„</span>Contracts</button>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     FOOTER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<footer class="footer z1">
  <div class="wrap">
    <div class="footer-grid">
      <div class="footer-brand">
        <div class="logo"><div class="logo-icon">AI</div><span class="logo-name">AITK<em>.</em></span></div>
        <p>The native token powering decentralized AI commerce on Polygon. Pay for AI services instantly, globally, and without permission.</p>
        <div class="social-row">
          <a href="#" class="soc-btn">ğ•</a>
          <a href="#" class="soc-btn">ğŸ’¬</a>
          <a href="#" class="soc-btn">ğŸ”µ</a>
          <a href="https://github.com" target="_blank" class="soc-btn">âŒ¨</a>
        </div>
      </div>
      <div class="footer-col">
        <h4>Platform</h4>
        <ul>
          <li><a href="#" onclick="showPage('swap')">Swap Tokens</a></li>
          <li><a href="#" onclick="showPage('services')">AI Services</a></li>
          <li><a href="#" onclick="showPage('portfolio')">Portfolio</a></li>
          <li><a href="#" onclick="showPage('contracts')">Contracts</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <h4>Resources</h4>
        <ul>
          <li><a href="https://polygonscan.com/token/0x6f9a52d1Bef12a602a9cE943E3eA95c5BbCB9B3d" target="_blank">PolygonScan</a></li>
          <li><a href="https://quickswap.exchange" target="_blank">QuickSwap</a></li>
          <li><a href="https://metamask.io" target="_blank">MetaMask</a></li>
          <li><a href="https://docs.ethers.org" target="_blank">ethers.js</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <h4>Network</h4>
        <ul>
          <li><a href="#">Chain ID: 137</a></li>
          <li><a href="#">RPC: polygon-rpc.com</a></li>
          <li><a href="#">Symbol: MATIC</a></li>
          <li><a href="#">Gas: ~$0.001</a></li>
        </ul>
      </div>
    </div>
    <div class="footer-bottom">
      <p>Â© 2025 AITK Platform Â· Polygon Mainnet Â· Built with ethers.js v6</p>
      <p>Block: <span id="footer-block" style="font-family:var(--font-mono);">â€”</span></p>
    </div>
  </div>
</footer>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     MODALS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

<!-- WALLET CONNECT -->
<div class="overlay" id="wallet-overlay" onclick="bgClose(event,'wallet-overlay')">
  <div class="modal">
    <div class="modal-stripe"></div>
    <button class="modal-close" onclick="closeOverlay('wallet-overlay')">âœ•</button>
    <div class="modal-inner">
      <div class="m-title">Connect Wallet</div>
      <div class="m-sub">Choose your wallet. Works on mobile and desktop â€” WalletConnect is recommended for phones.</div>

      <!-- QR section (hidden by default) -->
      <div id="qr-section" style="display:none;" class="qr-section">
        <div class="qr-box">
          <div id="qr-img" style="min-height:220px;display:flex;align-items:center;justify-content:center;">
            <div><div class="spinner" style="width:28px;height:28px;border-width:3px;margin:0 auto 12px;"></div><div style="color:var(--text2);font-size:13px;">Generating QRâ€¦</div></div>
          </div>
          <div style="font-size:12px;color:var(--text2);margin-top:12px;">ğŸ“± Scan with your wallet app</div>
        </div>
        <div class="qr-wallets">
          <span class="qr-w">MetaMask</span>
          <span class="qr-w">Trust Wallet</span>
          <span class="qr-w">Rainbow</span>
          <span class="qr-w">Coinbase</span>
          <span class="qr-w">+ any WC wallet</span>
        </div>
        <button class="back-btn" onclick="showWalletList()">â† Back to options</button>
      </div>

      <!-- Wallet list -->
      <div id="wallet-list" class="w-opts">
        <div class="w-opt featured" onclick="connectWC()">
          <div class="w-ic" style="background:rgba(59,153,252,0.1);">ğŸ”—</div>
          <div>
            <div class="w-name" style="color:var(--cyan);">WalletConnect</div>
            <div class="w-desc">ğŸ“± Scan QR Â· Any mobile wallet Â· No extension needed</div>
          </div>
          <span class="w-badge">MOBILE âœ“</span>
        </div>
        <div class="w-opt" onclick="connectMM()">
          <div class="w-ic" style="background:rgba(246,133,27,0.1);">ğŸ¦Š</div>
          <div>
            <div class="w-name">MetaMask</div>
            <div class="w-desc">Browser extension (desktop) Â· or deep link on mobile</div>
          </div>
          <span style="margin-left:auto;color:var(--text2);">â†’</span>
        </div>
        <div class="w-opt" onclick="connectTrust()">
          <div class="w-ic" style="background:rgba(51,117,187,0.1);">ğŸ›¡ï¸</div>
          <div>
            <div class="w-name">Trust Wallet</div>
            <div class="w-desc">Open in Trust Wallet app browser</div>
          </div>
          <span style="margin-left:auto;color:var(--text2);">â†’</span>
        </div>
        <div class="w-opt" onclick="connectInjected()">
          <div class="w-ic" style="background:rgba(157,78,221,0.1);">âš¡</div>
          <div>
            <div class="w-name">Browser Wallet</div>
            <div class="w-desc">Rabby, Frame, or any injected wallet</div>
          </div>
          <span style="margin-left:auto;color:var(--text2);">â†’</span>
        </div>
      </div>

      <p style="text-align:center;font-size:11px;color:var(--text3);margin-top:18px;">
        Needs <strong style="color:var(--cyan);">Polygon Mainnet (Chain ID 137)</strong> Â· Auto-switch on connect
      </p>
    </div>
  </div>
</div>

<!-- WALLET INFO -->
<div class="overlay" id="info-overlay" onclick="bgClose(event,'info-overlay')">
  <div class="modal" style="max-width:380px;">
    <div class="modal-stripe"></div>
    <button class="modal-close" onclick="closeOverlay('info-overlay')">âœ•</button>
    <div class="modal-inner">
      <div class="m-title">Connected</div>
      <div style="background:var(--bg3);border:1px solid var(--border2);border-radius:var(--r);padding:16px;margin:14px 0;">
        <div style="font-family:var(--font-mono);font-size:12px;word-break:break-all;" id="info-addr">â€”</div>
        <div style="font-size:12px;color:var(--text2);margin-top:6px;" id="info-net">Polygon Mainnet</div>
      </div>
      <div style="display:flex;gap:8px;">
        <button onclick="copyTxt(currentAccount,null,true)" style="flex:1;background:var(--card2);border:1px solid var(--border);color:var(--text);padding:11px;border-radius:var(--r);font-weight:600;font-size:13px;">Copy Address</button>
        <button onclick="disconnect()" style="flex:1;background:rgba(255,0,110,0.08);border:1px solid rgba(255,0,110,0.25);color:var(--pink);padding:11px;border-radius:var(--r);font-weight:600;font-size:13px;">Disconnect</button>
      </div>
    </div>
  </div>
</div>

<!-- PAY SERVICE -->
<div class="overlay" id="pay-overlay" onclick="bgClose(event,'pay-overlay')">
  <div class="modal">
    <div class="modal-stripe"></div>
    <button class="modal-close" onclick="closeOverlay('pay-overlay')">âœ•</button>
    <div class="modal-inner">
      <div class="m-title" id="pay-title">Pay for Service</div>
      <div class="m-sub" id="pay-sub">Enter your email below â€” your API key is delivered <strong style="color:var(--green);">instantly</strong> after payment confirms.</div>

      <div class="fee-box">
        <div class="info-row"><span class="k">Service ID</span><span class="v" id="pay-sid" style="font-size:10px;color:var(--cyan);">â€”</span></div>
        <div class="info-row"><span class="k">Price</span><span class="v" id="pay-price">â€”</span></div>
        <div class="info-row"><span class="k">Platform Fee</span><span class="v" id="pay-fee">â€”</span></div>
        <div class="info-row"><span class="k">Provider Receives</span><span class="v" id="pay-prov" style="color:var(--green);">â€”</span></div>
        <div class="info-row" style="margin-top:6px;border-top:1px solid var(--border);padding-top:6px;"><span class="k">Your Balance</span><span class="v" id="pay-bal">â€”</span></div>
      </div>

      <div class="form-field">
        <label class="f-label" style="color:var(--cyan);">ğŸ“§ Your Email Address <span style="color:var(--pink);font-weight:800;">*Required for delivery</span></label>
        <textarea class="f-textarea" id="pay-ref" placeholder="your@email.com â€” API key sent here instantly after payment" style="border-color:rgba(0,212,255,0.3);font-size:15px;"></textarea>
        <div style="background:rgba(0,255,136,0.06);border:1px solid rgba(0,255,136,0.2);border-radius:8px;padding:10px 13px;margin-top:8px;font-size:12px;color:var(--green);display:flex;gap:8px;align-items:flex-start;">
          <span style="flex-shrink:0;">âœ…</span>
          <span>Your API key will be emailed to you <strong>instantly</strong> after payment confirms on Polygon (~2 seconds). Check your spam folder if not received.</span>
        </div>
      </div>

      <div class="status-box" id="pay-status" style="display:none;">
        <span class="s-dot spin" id="pay-dot"></span>
        <div class="s-body">
          <div class="s-msg" id="pay-msg">Processingâ€¦</div>
          <a class="s-link" id="pay-link" href="#" target="_blank" style="display:none;">View on PolygonScan â†—</a>
        </div>
      </div>

      <button class="btn-go primary" id="pay-btn" onclick="doPay()">Confirm Payment</button>
      <p style="text-align:center;font-size:11px;color:var(--text3);margin-top:10px;">Approve the router once before paying Â· Auto-checked on confirm</p>
    </div>
  </div>
</div>

<!-- REGISTER SERVICE -->
<div class="overlay" id="register-overlay" onclick="bgClose(event,'register-overlay')">
  <div class="modal">
    <div class="modal-stripe"></div>
    <button class="modal-close" onclick="closeOverlay('register-overlay')">âœ•</button>
    <div class="modal-inner">
      <div class="m-title">Register AI Service</div>
      <div class="m-sub">Calls <code style="color:var(--green);font-family:var(--font-mono);">registerService()</code> on-chain. Requires admin wallet.</div>

      <div class="form-field">
        <label class="f-label">Service Name</label>
        <input class="f-input" id="reg-name" placeholder="e.g. GPT-4 API Credits" oninput="previewId()">
        <div style="font-size:11px;color:var(--text2);margin-top:5px;">ID: <span id="reg-id-preview" style="color:var(--green);font-family:var(--font-mono);"></span></div>
      </div>
      <div class="form-field">
        <label class="f-label">Provider Address</label>
        <input class="f-input" id="reg-provider" placeholder="0xâ€¦ wallet that receives AITK">
      </div>
      <div class="form-field">
        <label class="f-label">Price (whole AITK tokens)</label>
        <input class="f-input" id="reg-price" type="number" placeholder="500">
      </div>
      <div class="form-field">
        <label class="f-label">Royalty Recipient (optional)</label>
        <input class="f-input" id="reg-roy-addr" placeholder="0xâ€¦ or leave blank">
      </div>
      <div class="form-field">
        <label class="f-label">Royalty BPS (e.g. 500 = 5%)</label>
        <input class="f-input" id="reg-roy-bps" type="number" placeholder="0">
      </div>

      <div class="status-box" id="reg-status" style="display:none;">
        <span class="s-dot spin" id="reg-dot"></span>
        <div class="s-body">
          <div class="s-msg" id="reg-msg">Processingâ€¦</div>
          <a class="s-link" id="reg-link" href="#" target="_blank" style="display:none;">View on PolygonScan â†—</a>
        </div>
      </div>
      <button class="btn-go primary" onclick="doRegister()">Register Service</button>
    </div>
  </div>
</div>

<!-- TOAST STACK -->
<div class="toast-stack" id="toast-stack"></div>

<script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   AITK PLATFORM â€” Full Web3 Integration
   ethers.js v6 Â· Polygon Mainnet Â· Your exact ABI
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
'use strict';

// â”€â”€ CONSTANTS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const TOKEN  = '0x6f9a52d1Bef12a602a9cE943E3eA95c5BbCB9B3d';
const ROUTER = '0x792668a0E8De5B7B07A3cfffFeD82cDdEF6738A8';
const POLY_ID  = 137n;
const POLY_HEX = '0x89';
const POLY_RPCS = [
  'https://polygon.llamarpc.com',
  'https://rpc.ankr.com/polygon',
  'https://polygon-rpc.com',
  'https://1rpc.io/matic',
  'https://rpc-mainnet.maticvigil.com',
  'https://matic-mainnet.chainstacklabs.com',
];
const CHAINLINK_FEED = '0xAB594600376Ec9fD91F8e885dADF0CE036862dE';
// Get FREE at polygonscan.com/myapikey
const PSCAN_KEY = '859S2B6RU8YJ43DFHISRHISW3NJKYHS4RW';
// Get FREE at cloud.walletconnect.com
const WC_PID = '696ff19c1bba5052f8ae8adfa9d9b26a';

// â”€â”€ ABIS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const ERC20 = [
  'function totalSupply() view returns (uint256)',
  'function balanceOf(address) view returns (uint256)',
  'function approve(address,uint256) returns (bool)',
  'function allowance(address,address) view returns (uint256)',
];
const ROUTER_ABI = [
  'function paymentToken() view returns (address)',
  'function treasury() view returns (address)',
  'function platformFeeBps() view returns (uint16)',
  'function accumulatedFees() view returns (uint256)',
  'function services(bytes32) view returns (address provider, uint256 price, bool active)',
  'function providerEnabled(address) view returns (bool)',
  'function payOnChain(bytes32 serviceId, string refNote)',
  'function registerService(bytes32,address,uint256,address[],uint16[])',
  'function updateService(bytes32,uint256,bool)',
  'event PaymentReceived(address indexed payer, bytes32 indexed serviceId, address provider, uint256 amountPaid, uint256 platformFee, string refNote)',
  'event ServiceRegistered(bytes32 indexed serviceId, address indexed provider, uint256 price)',
];
const FEED_ABI = ['function latestRoundData() view returns (uint80,int256,uint256,uint256,uint80)'];

// â”€â”€ SERVICE CATALOGUE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const SERVICES = [
  { key:'gpt4-credits',   cat:'llm',     name:'GPT-4 API Credits',    desc:'OpenAI GPT-4 Turbo API credits. Instant allocation to your API key after payment.',        icon:'ğŸ§ ', color:'rgba(0,212,255,0.12)',  price:'500',  unit:'per 1M tokens' },
  { key:'claude-credits', cat:'llm',     name:'Claude API Credits',   desc:'Anthropic Claude 3.5 API credits. Best-in-class reasoning and coding capabilities.',       icon:'âš¡', color:'rgba(157,78,221,0.12)', price:'420',  unit:'per 1M tokens' },
  { key:'gemini-credits', cat:'llm',     name:'Gemini Pro Credits',   desc:'Google Gemini Pro API credits. Multimodal AI with text, image, and code support.',         icon:'ğŸ’', color:'rgba(0,255,136,0.12)',  price:'380',  unit:'per 1M tokens' },
  { key:'gpu-hours',      cat:'compute', name:'GPU Compute Hours',    desc:'NVIDIA A100/H100 GPU hours for model training, fine-tuning, and batch inference at scale.', icon:'ğŸ–¥ï¸', color:'rgba(255,190,11,0.1)',  price:'1200', unit:'per GPU hour'  },
  { key:'image-gen',      cat:'gen',     name:'Image Generation',     desc:'DALLÂ·E 3, Stable Diffusion XL, and Midjourney-quality images. Pay per image with AITK.',   icon:'ğŸ¨', color:'rgba(255,0,110,0.1)',   price:'50',   unit:'per image'     },
  { key:'fine-tuning',    cat:'compute', name:'Model Fine-Tuning',    desc:'Fine-tune LLaMA 3, Mistral, or Falcon on your own dataset. Full pipeline included.',       icon:'ğŸ”¬', color:'rgba(0,212,255,0.08)',  price:'8000', unit:'per job'       },
  { key:'vector-db',      cat:'compute', name:'Vector Database',      desc:'Managed Pinecone/Qdrant vector storage for RAG pipelines. Pay monthly in AITK.',           icon:'ğŸ“¡', color:'rgba(0,255,136,0.08)',  price:'300',  unit:'per month'     },
  { key:'tts-api',        cat:'gen',     name:'Text-to-Speech API',   desc:'ElevenLabs-quality voice synthesis. 50+ voices, 30+ languages. Instant AITK payment.',     icon:'ğŸ™ï¸', color:'rgba(157,78,221,0.1)',  price:'120',  unit:'per 1M chars'  },
  { key:'whisper-api',    cat:'llm',     name:'Speech-to-Text API',   desc:'OpenAI Whisper transcription. Highly accurate, supports 99 languages. Pay per minute.',    icon:'ğŸ§', color:'rgba(255,190,11,0.08)', price:'80',   unit:'per audio hour'},
];

// â”€â”€ STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let ethProvider  = null;
let readProv     = null;
let signer       = null;
let currentAccount = null;
let chainId      = null;
let maticPrice   = 0;
let feeBps       = 0;
let slippage     = 0.5;
let aitkRate     = 238.09; // AITK per MATIC (fallback)
let wcProv       = null;
let pendingSvc   = null;
let svcFilter    = 'all';

// â”€â”€ CANVAS BACKGROUND â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
(function initCanvas() {
  const c = document.getElementById('bg-canvas');
  const ctx = c.getContext('2d');
  let W, H, nodes = [];

  function resize() {
    W = c.width  = window.innerWidth;
    H = c.height = window.innerHeight;
  }
  resize();
  window.addEventListener('resize', resize);

  for (let i = 0; i < 60; i++) {
    nodes.push({
      x: Math.random() * 1920, y: Math.random() * 1080,
      vx: (Math.random()-0.5)*0.3, vy: (Math.random()-0.5)*0.3,
      r: Math.random()*1.5+0.5,
    });
  }

  function draw() {
    ctx.clearRect(0,0,W,H);
    // Draw connections
    for (let i = 0; i < nodes.length; i++) {
      for (let j = i+1; j < nodes.length; j++) {
        const dx = nodes[i].x - nodes[j].x;
        const dy = nodes[i].y - nodes[j].y;
        const d  = Math.sqrt(dx*dx+dy*dy);
        if (d < 200) {
          ctx.beginPath();
          ctx.moveTo(nodes[i].x, nodes[i].y);
          ctx.lineTo(nodes[j].x, nodes[j].y);
          ctx.strokeStyle = `rgba(0,212,255,${0.06*(1-d/200)})`;
          ctx.lineWidth = 0.5;
          ctx.stroke();
        }
      }
    }
    // Draw nodes
    nodes.forEach(n => {
      ctx.beginPath();
      ctx.arc(n.x, n.y, n.r, 0, Math.PI*2);
      ctx.fillStyle = 'rgba(0,212,255,0.4)';
      ctx.fill();
      n.x += n.vx; n.y += n.vy;
      if (n.x < 0 || n.x > W) n.vx *= -1;
      if (n.y < 0 || n.y > H) n.vy *= -1;
    });
    requestAnimationFrame(draw);
  }
  draw();
})();

// â”€â”€ SMART RPC WITH FALLBACK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function getBestRPC() {
  for (const rpc of POLY_RPCS) {
    try {
      const p = new ethers.JsonRpcProvider(rpc);
      // Test with a quick call
      await Promise.race([
        p.getBlockNumber(),
        new Promise((_,rej) => setTimeout(()=>rej(new Error('timeout')), 3000))
      ]);
      console.log('âœ… RPC connected:', rpc);
      return p;
    } catch(e) {
      console.warn('âŒ RPC failed:', rpc, e.message);
    }
  }
  // Last resort â€” return first one anyway
  return new ethers.JsonRpcProvider(POLY_RPCS[0]);
}

// â”€â”€ INIT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
window.addEventListener('load', async () => {
  // Try all RPCs, use the first one that works
  readProv = await getBestRPC();
  renderServices('all');
  buildReads();
  await loadPublic();

  // Auto-reconnect injected wallet
  if (window.ethereum) {
    window.ethereum.on('accountsChanged', a => a.length ? finish(a[0]) : disconnect());
    window.ethereum.on('chainChanged', id => { chainId = BigInt(id); checkNet(); if (currentAccount) loadWallet(); });
    try {
      const a = await window.ethereum.request({method:'eth_accounts'});
      if (a.length) await finish(a[0]);
    } catch {}
  }

  setInterval(loadPublic, 30000);
});

// â”€â”€ PUBLIC DATA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function loadPublic() {
  await Promise.allSettled([fetchPrice(), fetchStats(), fetchBlock()]);
}

async function fetchPrice() {
  try {
    const f = new ethers.Contract(CHAINLINK_FEED, FEED_ABI, readProv);
    const [,ans] = await f.latestRoundData();
    maticPrice = Number(ans)/1e8;
  } catch {
    try {
      const r = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=matic-network&vs_currencies=usd');
      const d = await r.json();
      maticPrice = d?.['matic-network']?.usd || 0;
    } catch {}
  }
  const m = '$'+maticPrice.toFixed(4);
  const ai = '$'+(maticPrice/aitkRate).toFixed(6);
  $$([ 'tk-matic','tk-matic2','h-matic','mp-matic'], m);
  $$(['tk-price','tk-price2','h-price','mp-price'], ai);
  if (currentAccount) refreshUSD();
}

async function fetchStats() {
  try {
    const r = new ethers.Contract(ROUTER, ROUTER_ABI, readProv);
    const [f, acc] = await Promise.all([r.platformFeeBps(), r.accumulatedFees()]);
    feeBps = Number(f);
    const fp  = (feeBps/100).toFixed(2)+'%';
    const af  = fmtBig(acc,18)+' AITK';
    $$(['tk-fee','tk-fee2','h-fee','mp-fee','ctr-fee'], fp);
    $$(['tk-acc','tk-acc2','h-acc','mp-acc','ctr-acc'], af);
    if ($('s-fee')) $('s-fee').textContent = fp;
    if ($('s-accfee')) $('s-accfee').textContent = af;
  } catch(e) {
    console.warn('stats error, retrying with fallback RPC:', e.message);
    try {
      readProv = await getBestRPC();
      const r2 = new ethers.Contract(ROUTER, ROUTER_ABI, readProv);
      const [f2, acc2] = await Promise.all([r2.platformFeeBps(), r2.accumulatedFees()]);
      feeBps = Number(f2);
      const fp2 = (feeBps/100).toFixed(2)+'%';
      const af2 = fmtBig(acc2,18)+' AITK';
      $$(['tk-fee','tk-fee2','mp-fee','ctr-fee'], fp2);
      $$(['tk-acc','tk-acc2','mp-acc','ctr-acc'], af2);
    } catch(e2) { console.warn('stats retry also failed:', e2.message); }
  }
  try {
    const t = new ethers.Contract(TOKEN, ERC20, readProv);
    const s = await t.totalSupply();
    const f = fmtBig(s,18)+' AITK';
    $$(['h-supply','mp-supply','ctr-supply'], f);
  } catch {}
}

async function fetchBlock() {
  try {
    const b = await readProv.getBlockNumber();
    const f = '#'+b.toLocaleString();
    $$(['tk-block','tk-block2','h-block','footer-block'], f);
    if ($('ph-block')) $('ph-block').textContent = 'Block: '+f;
  } catch {}
}

// â”€â”€ WALLET CONNECTION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function connectWC() {
  closeOverlay('wallet-overlay');
  document.getElementById('qr-section').style.display = 'block';
  document.getElementById('wallet-list').style.display = 'none';
  openOverlay('wallet-overlay');

  try {
    // WalletConnect via direct URI generation
    // For full WC v2 support, the project ID is needed
    // This shows a deep link + QR that works for most wallets
    const page = encodeURIComponent(window.location.href);
    const qr   = document.getElementById('qr-img');
    qr.innerHTML = `
      <div class="qr-img-wrap">
        <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${page}"
             width="200" height="200" style="display:block;border-radius:4px;"
             onerror="this.parentElement.innerHTML='<p style=color:%23555;padding:10px;font-size:12px;>QR unavailable â€” use deep links below</p>'">
      </div>
      <div style="margin-top:12px;font-size:13px;color:var(--green);font-weight:600;">
        ğŸ“± Or use the buttons below on your phone
      </div>
      <div style="display:flex;flex-direction:column;gap:10px;margin-top:14px;">
        <a href="metamask://dapp/${window.location.hostname || 'localhost'}" style="background:rgba(246,133,27,0.12);border:1px solid rgba(246,133,27,0.3);color:#f6851b;padding:13px 20px;border-radius:11px;text-decoration:none;font-weight:700;font-size:14px;display:block;text-align:center;">ğŸ¦Š Open in MetaMask App</a>
        <a href="trust://browser_enable?url=${page}" style="background:rgba(51,117,187,0.12);border:1px solid rgba(51,117,187,0.3);color:#3375bb;padding:13px 20px;border-radius:11px;text-decoration:none;font-weight:700;font-size:14px;display:block;text-align:center;">ğŸ›¡ï¸ Open in Trust Wallet</a>
        <a href="https://link.trustwallet.com/open_url?coin_id=966&url=${page}" style="background:rgba(51,117,187,0.08);border:1px solid rgba(51,117,187,0.2);color:#3375bb;padding:13px 20px;border-radius:11px;text-decoration:none;font-weight:600;font-size:13px;display:block;text-align:center;">ğŸ›¡ï¸ Trust Wallet (alt link)</a>
      </div>`;
  } catch(e) {
    toast('WC error', e.message, 'err');
    showWalletList();
  }
}

function showWalletList() {
  document.getElementById('qr-section').style.display = 'none';
  document.getElementById('wallet-list').style.display = 'flex';
}

async function connectMM() {
  closeOverlay('wallet-overlay');
  const mob = /Android|iPhone|iPad/i.test(navigator.userAgent);
  if (mob && !window.ethereum) {
    const url = encodeURIComponent(window.location.href);
    window.location.href = `https://metamask.app.link/dapp/${window.location.hostname || 'localhost'}`;
    toast('Opening MetaMaskâ€¦','If nothing opens, install MetaMask from Play Store','inf');
    return;
  }
  await connectInjected();
}

function connectTrust() {
  closeOverlay('wallet-overlay');
  const mob = /Android|iPhone|iPad/i.test(navigator.userAgent);
  if (mob && !window.ethereum) {
    const url = encodeURIComponent(window.location.href);
    window.location.href = `https://link.trustwallet.com/open_url?coin_id=966&url=${url}`;
    toast('Opening Trust Walletâ€¦','','inf');
    return;
  }
  connectInjected();
}

async function connectInjected() {
  closeOverlay('wallet-overlay');
  if (!window.ethereum) {
    toast('No wallet detected','Use WalletConnect or install MetaMask','err');
    return;
  }
  try {
    setBtnSwap('<span class="spinner"></span> Connectingâ€¦', true);
    const accs = await window.ethereum.request({method:'eth_requestAccounts'});
    ethProvider = new ethers.BrowserProvider(window.ethereum);
    signer = await ethProvider.getSigner();
    await finish(accs[0]);
  } catch(e) {
    setBtnSwap('Connect Wallet to Swap', false);
    if (e.code !== 4001) toast('Connection failed', e.message||'', 'err');
  }
}

async function finish(addr) {
  if (!ethProvider && window.ethereum) {
    ethProvider = new ethers.BrowserProvider(window.ethereum);
    signer = await ethProvider.getSigner();
  }
  currentAccount = addr;
  const net = await ethProvider.getNetwork();
  chainId = net.chainId;

  // Update UI
  $('btn-connect').style.display  = 'none';
  $('wallet-chip').style.display  = 'flex';
  $('chip-addr').textContent      = short(addr);
  $('info-addr').textContent      = addr;
  $('net-pill').style.display     = 'flex';
  $('ph-wallet').textContent      = short(addr);
  $('mp-wallet').textContent      = short(addr);

  await checkNet();
  await loadWallet();
  toast('Wallet connected âœ“', short(addr), 'ok');
  setBtnSwap('Swap Tokens', false);
}

async function checkNet() {
  const pill = $('net-pill');
  if (chainId !== POLY_ID) {
    pill.className = 'net-pill bad';
    $('net-lbl').textContent = 'Wrong Network';
    toast('Wrong network','Switching to Polygonâ€¦','err');
    try {
      const prov = window.ethereum || wcProv;
      await prov.request({method:'wallet_switchEthereumChain', params:[{chainId:POLY_HEX}]});
      chainId = POLY_ID;
      pill.className = 'net-pill';
      $('net-lbl').textContent = 'Polygon';
    } catch(e) {
      if (e.code===4902) await addPoly();
    }
  } else {
    pill.className = 'net-pill';
    $('net-lbl').textContent = 'Polygon';
    $('ph-net').textContent  = 'Polygon âœ“';
  }
}

async function addPoly() {
  await window.ethereum.request({
    method:'wallet_addEthereumChain',
    params:[{
      chainId: POLY_HEX,
      chainName: 'Polygon Mainnet',
      nativeCurrency:{name:'MATIC',symbol:'MATIC',decimals:18},
      rpcUrls:['https://polygon.llamarpc.com','https://rpc.ankr.com/polygon','https://polygon-rpc.com','https://1rpc.io/matic'],
      blockExplorerUrls:['https://polygonscan.com'],
    }],
  });
}

function disconnect() {
  closeOverlay('info-overlay');
  if (wcProv) { try{wcProv.disconnect();}catch{} wcProv=null; }
  ethProvider=signer=currentAccount=null;
  $('btn-connect').style.display  = 'flex';
  $('wallet-chip').style.display  = 'none';
  $('net-pill').style.display     = 'none';
  $$(['ph-aitk','ph-matic','ph-allow','ph-net','ph-wallet','mp-aitk','mp-mbal','mp-allow','mp-wallet'],  'â€”');
  $$(['ph-aitk-usd','ph-matic-usd'], 'Connect wallet');
  $$(['from-bal','to-bal'], 'Balance: â€”');
  setBtnSwap('Connect Wallet to Swap', false);
  $('approve-banner').style.display = 'none';
  $('tx-list').innerHTML = `<div style="text-align:center;padding:48px;color:var(--text2);">
    <div style="font-size:44px;margin-bottom:14px;opacity:0.3;">ğŸ”—</div>
    <div style="font-family:var(--font-display);font-weight:700;font-size:18px;margin-bottom:8px;">Connect Your Wallet</div>
    <div style="font-size:14px;margin-bottom:20px;">View your AITK transaction history on Polygon</div>
    <button class="btn-go primary" style="width:auto;padding:12px 32px;" onclick="openOverlay('wallet-overlay')">Connect Wallet</button>
  </div>`;
  toast('Disconnected','','inf');
}

// â”€â”€ WALLET DATA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function loadWallet() {
  if (!currentAccount || !ethProvider) return;
  try {
    const tok = new ethers.Contract(TOKEN, ERC20, readProv);
    const [maticBal, aitkBal, allow] = await Promise.all([
      ethProvider.getBalance(currentAccount),
      tok.balanceOf(currentAccount),
      tok.allowance(currentAccount, ROUTER),
    ]);

    const mF = parseFloat(ethers.formatEther(maticBal)).toFixed(4);
    const aF = parseFloat(ethers.formatEther(aitkBal)).toFixed(2);
    const lF = allow >= ethers.MaxUint256/2n ? 'âˆ Unlimited' : parseFloat(ethers.formatEther(allow)).toFixed(2);

    $$(['ph-matic','mp-mbal'],   mF+' MATIC');
    $$(['ph-aitk','mp-aitk'],    aF+' AITK');
    $$(['ph-allow','mp-allow'],  lF);
    $('from-bal').textContent = 'Balance: '+mF+' MATIC';
    $('to-bal').textContent   = 'Balance: '+aF+' AITK';

    // Show approve banner if no allowance
    const needsApprove = allow === 0n;
    $('approve-banner').style.display = needsApprove ? 'flex' : 'none';
    $('allow-status') && ($('allow-status').textContent = needsApprove ? 'âš ï¸ Not approved' : 'âœ… Approved');

    refreshUSD(maticBal, aitkBal);
    await loadTxHistory();
    await loadWallet_service_statuses();
  } catch(e) { console.warn('loadWallet',e); }
}

function refreshUSD(mBal, aBal) {
  if (!maticPrice) return;
  if (mBal) $('ph-matic-usd').textContent = 'â‰ˆ $'+(parseFloat(ethers.formatEther(mBal))*maticPrice).toFixed(2);
  if (aBal) $('ph-aitk-usd').textContent  = 'â‰ˆ $'+(parseFloat(ethers.formatEther(aBal))*(maticPrice/aitkRate)).toFixed(4);
}

async function loadWallet_service_statuses() {
  try {
    const r = new ethers.Contract(ROUTER, ROUTER_ABI, readProv);
    for (const svc of SERVICES) {
      const sid = ethers.id(svc.key);
      try {
        const [,price,active] = await r.services(sid);
        const el = $('svc-badge-'+svc.key);
        if (el) {
          if (price > 0n) {
            el.textContent  = active ? 'âœ“ On-Chain' : 'Inactive';
            el.className    = 'svc-badge '+(active ? 'live' : 'reg');
          } else {
            el.textContent  = 'Register';
            el.className    = 'svc-badge soon';
          }
        }
      } catch {}
    }
  } catch {}
}

// â”€â”€ APPROVE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function approveMax() {
  if (!signer) { openOverlay('wallet-overlay'); return; }
  const btn = $('approve-btn');
  btn.innerHTML = '<span class="spinner"></span> Approvingâ€¦';
  btn.disabled = true;
  try {
    const tok = new ethers.Contract(TOKEN, ERC20, signer);
    const tx  = await tok.approve(ROUTER, ethers.MaxUint256);
    toast('Approval sent','Waiting for confirmationâ€¦','inf');
    await tx.wait();
    toast('Approved âœ“','Router can now spend your AITK','ok');
    $('approve-banner').style.display = 'none';
    $$(['ph-allow','mp-allow'], 'âˆ Unlimited');
  } catch(e) {
    toast('Approval failed', e.reason||e.message, 'err');
  }
  btn.innerHTML = 'Approve Now';
  btn.disabled = false;
}

async function revokeApproval() {
  if (!signer) return;
  try {
    const tok = new ethers.Contract(TOKEN, ERC20, signer);
    const tx  = await tok.approve(ROUTER, 0n);
    await tx.wait();
    toast('Revoked','Allowance set to 0','inf');
    $$(['ph-allow','mp-allow'], '0 AITK');
    $('approve-banner').style.display = 'flex';
  } catch(e) { toast('Revoke failed',e.message,'err'); }
}

// â”€â”€ SWAP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function calcOut() {
  const v = parseFloat($('from-amt').value);
  if (!v || v<=0) { $('to-amt').value=''; $('swap-info').style.display='none'; return; }
  const out = v*aitkRate;
  const min = out*(1-slippage/100);
  const fee = out*feeBps/10000;
  $('to-amt').value    = out.toFixed(2);
  $('swap-info').style.display = 'block';
  $('rate-v').textContent      = '1 MATIC = '+aitkRate.toFixed(2)+' AITK';
  $('fee-v').textContent       = (feeBps/100).toFixed(2)+'% = '+fee.toFixed(2)+' AITK';
  $('slip-v').textContent      = slippage+'%';
  $('min-v').textContent       = min.toFixed(2)+' AITK';
  if (currentAccount) setBtnSwap('Swap '+v+' MATIC â†’ '+out.toFixed(2)+' AITK', false);
}

function setSlip(v, btn, custom) {
  slippage = v;
  if (!custom) {
    document.querySelectorAll('.slip-btn').forEach(b=>b.classList.remove('on'));
    if (btn) btn.classList.add('on');
  }
  calcOut();
}

async function handleSwap() {
  if (!currentAccount) { openOverlay('wallet-overlay'); return; }
  if (chainId !== POLY_ID) { await checkNet(); return; }
  const amt = $('from-amt').value;
  if (!amt||parseFloat(amt)<=0) { toast('Enter amount','','err'); return; }
  const qs = `https://quickswap.exchange/#/swap?inputCurrency=MATIC&outputCurrency=${TOKEN}&exactAmount=${amt}`;
  setStatus('swap-status','sw-dot','sw-msg','spin','âœ… Opening QuickSwap for MATIC â†’ AITK swapâ€¦');
  $('sw-link').style.display = 'block';
  $('sw-link').href = qs;
  $('sw-link').textContent = 'Open QuickSwap â†—';
  setTimeout(()=>window.open(qs,'_blank'),600);
  toast('Opening QuickSwap','Swap your MATIC for AITK, then return to pay for services','inf');
}

// â”€â”€ PAY FOR SERVICE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function openPayModal(svc) {
  if (!currentAccount) { openOverlay('wallet-overlay'); return; }
  pendingSvc = svc;
  const sid  = ethers.id(svc.key);
  const fee  = (Number(svc.price)*feeBps/10000).toFixed(2);
  const prov = (Number(svc.price)-parseFloat(fee)).toFixed(2);

  $('pay-title').textContent = 'Pay: '+svc.name;
  $('pay-sid').textContent   = sid.slice(0,18)+'â€¦';
  $('pay-price').textContent = Number(svc.price).toLocaleString()+' AITK';
  $('pay-fee').textContent   = (feeBps/100).toFixed(2)+'% = '+fee+' AITK';
  $('pay-prov').textContent  = prov+' AITK';
  $('pay-ref').value         = '';
  $('pay-status').style.display = 'none';
  $('pay-btn').disabled         = false;
  $('pay-btn').textContent      = 'Confirm Payment';

  // Load balance
  (async()=>{
    try {
      const b = await new ethers.Contract(TOKEN, ERC20, readProv).balanceOf(currentAccount);
      $('pay-bal').textContent = parseFloat(ethers.formatEther(b)).toFixed(2)+' AITK';
    } catch { $('pay-bal').textContent = 'â€”'; }
  })();

  openOverlay('pay-overlay');
}

async function doPay() {
  if (!signer||!pendingSvc) return;
  const ref  = $('pay-ref').value.trim();

  // Validate email
  const emailRegex = /[a-zA-Z0-9._%+\-]+@[a-zA-Z0-9.\-]+\.[a-zA-Z]{2,}/;
  if (!emailRegex.test(ref)) {
    // Shake the field and show error
    const field = $('pay-ref');
    field.style.borderColor = 'var(--pink)';
    field.style.animation = 'shake 0.4s ease';
    field.focus();
    setTimeout(() => { field.style.borderColor = ''; field.style.animation = ''; }, 1500);
    toast('Email required', 'Enter your email address to receive your API key', 'err');
    return;
  }
  const sid  = ethers.id(pendingSvc.key);
  const priceWei = ethers.parseEther(pendingSvc.price);
  const btn  = $('pay-btn');
  btn.innerHTML = '<span class="spinner"></span> Confirm in Walletâ€¦';
  btn.disabled  = true;
  $('pay-status').style.display = 'flex';

  try {
    const tok    = new ethers.Contract(TOKEN, ERC20, signer);
    const router = new ethers.Contract(ROUTER, ROUTER_ABI, signer);

    // Check allowance
    setStatus('pay-status','pay-dot','pay-msg','spin','Step 1/2: Checking allowanceâ€¦');
    const allow = await tok.allowance(currentAccount, ROUTER);
    if (allow < priceWei) {
      setStatus('pay-status','pay-dot','pay-msg','spin','Step 1/2: Approve routerâ€¦');
      const appTx = await tok.approve(ROUTER, ethers.MaxUint256);
      await appTx.wait();
      toast('Approved âœ“','Now payingâ€¦','ok');
    }

    // Pay
    setStatus('pay-status','pay-dot','pay-msg','spin','Step 2/2: Confirm payment in walletâ€¦');
    const tx = await router.payOnChain(sid, ref||'');
    setStatus('pay-status','pay-dot','pay-msg','spin','Submitted â€” waiting for confirmationâ€¦');
    showLink('pay-link', tx.hash);
    const receipt = await tx.wait();
    setStatus('pay-status','pay-dot','pay-msg','ok','âœ… Payment confirmed! Block #'+receipt.blockNumber);
    toast('Payment successful âœ“', pendingSvc.name+' paid', 'ok');
    btn.textContent = 'âœ… Paid Successfully!';
    setTimeout(()=>closeOverlay('pay-overlay'), 3000);
    loadWallet();
    fetchStats();
  } catch(e) {
    const msg = e.reason||e.shortMessage||e.message||'Transaction failed';
    setStatus('pay-status','pay-dot','pay-msg','err','âŒ '+msg);
    toast('Payment failed', msg, 'err');
    btn.innerHTML = 'Retry Payment';
    btn.disabled  = false;
  }
}

// â”€â”€ REGISTER SERVICE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function previewId() {
  const n = $('reg-name').value.trim();
  if (!n) { $('reg-id-preview').textContent=''; return; }
  const k   = n.toLowerCase().replace(/\s+/g,'-').replace(/[^a-z0-9-]/g,'');
  const sid = ethers.id(k);
  $('reg-id-preview').textContent = sid.slice(0,22)+'â€¦';
  $('reg-name')._key = k;
}

async function doRegister() {
  if (!signer) { openOverlay('wallet-overlay'); return; }
  const name   = $('reg-name').value.trim();
  const key    = $('reg-name')._key || name.toLowerCase().replace(/\s+/g,'-');
  const pAddr  = $('reg-provider').value.trim();
  const price  = $('reg-price').value;
  const rAddr  = $('reg-roy-addr').value.trim();
  const rBps   = $('reg-roy-bps').value;

  if (!name||!pAddr||!price) { toast('Missing fields','Fill name, provider, price','err'); return; }
  if (!ethers.isAddress(pAddr)) { toast('Invalid address','Check provider address','err'); return; }

  $('reg-status').style.display = 'flex';
  setStatus('reg-status','reg-dot','reg-msg','spin','Confirm in walletâ€¦');

  try {
    const router  = new ethers.Contract(ROUTER, ROUTER_ABI, signer);
    const sid     = ethers.id(key);
    const pw      = ethers.parseEther(price);
    const recips  = rAddr && ethers.isAddress(rAddr) ? [rAddr] : [];
    const bpsList = recips.length ? [parseInt(rBps)||0] : [];
    const tx = await router.registerService(sid, pAddr, pw, recips, bpsList);
    setStatus('reg-status','reg-dot','reg-msg','spin','Submitted â€” waitingâ€¦');
    showLink('reg-link', tx.hash);
    const rec = await tx.wait();
    setStatus('reg-status','reg-dot','reg-msg','ok','âœ… Registered! Block #'+rec.blockNumber);
    toast('Service registered âœ“', name, 'ok');
    setTimeout(()=>{ closeOverlay('register-overlay'); loadWallet_service_statuses(); }, 2000);
  } catch(e) {
    const msg = e.reason||e.shortMessage||e.message;
    setStatus('reg-status','reg-dot','reg-msg','err','âŒ '+msg);
    toast('Registration failed', msg, 'err');
  }
}

// â”€â”€ TX HISTORY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function loadTxHistory() {
  if (!currentAccount) return;
  const box = $('tx-list');
  box.innerHTML = '<div style="padding:18px 14px;color:var(--text2);font-size:13px;">Loading transactionsâ€¦</div>';
  try {
    const url = `https://api.polygonscan.com/api?module=account&action=tokentx&contractaddress=${TOKEN}&address=${currentAccount}&sort=desc&offset=25&page=1&apikey=${PSCAN_KEY}`;
    const d   = await fetch(url).then(r=>r.json());
    if (!Array.isArray(d.result)||d.result.length===0) { renderDemoTx(box); return; }
    box.innerHTML = d.result.map(tx=>{
      const recv = tx.to.toLowerCase()===currentAccount.toLowerCase();
      const amt  = parseFloat(ethers.formatUnits(tx.value, parseInt(tx.tokenDecimal))).toFixed(2);
      const dt   = new Date(parseInt(tx.timeStamp)*1000).toLocaleString();
      const cls  = recv?'recv':'send';
      const ico  = recv?'ğŸ“¥':'ğŸ“¤';
      const sign = recv?'+':'-';
      const vc   = recv?'pos':'neg';
      return `<div class="tx-row" onclick="window.open('https://polygonscan.com/tx/${tx.hash}','_blank')">
        <div class="tx-ic ${cls}">${ico}</div>
        <div class="tx-info"><div class="tx-name">${recv?'Receive':'Send'} AITK</div><div class="tx-hash">${short(tx.hash)}</div></div>
        <div class="tx-right"><div class="tx-amt ${vc}">${sign}${amt} AITK</div><div class="tx-date">${dt}</div></div>
      </div>`;
    }).join('');
  } catch { renderDemoTx(box); }
}

function renderDemoTx(box) {
  box.innerHTML = `
    <div style="margin:12px;padding:12px 14px;background:rgba(0,212,255,0.05);border:1px solid rgba(0,212,255,0.15);border-radius:10px;font-size:12px;color:var(--text2);">
      <strong style="color:var(--cyan);">â„¹ï¸</strong> Add your free PolygonScan API key (<code style="color:var(--green);">PSCAN_KEY</code>) for real TX history.
      Get it free at <a href="https://polygonscan.com/myapikey" target="_blank" style="color:var(--cyan);">polygonscan.com/myapikey</a>
    </div>
    <div class="tx-row"><div class="tx-ic recv">ğŸ“¥</div><div class="tx-info"><div class="tx-name">Receive AITK</div><div class="tx-hash">0x4a2fâ€¦c891 Â· Sample</div></div><div class="tx-right"><div class="tx-amt pos">+10,000 AITK</div><div class="tx-date">Sample data</div></div></div>
    <div class="tx-row"><div class="tx-ic pay">ğŸ¤–</div><div class="tx-info"><div class="tx-name">payOnChain Â· GPT-4 Credits</div><div class="tx-hash">0x9e1aâ€¦44f2 Â· Sample</div></div><div class="tx-right"><div class="tx-amt neg">-500 AITK</div><div class="tx-date">Sample data</div></div></div>
    <div class="tx-row"><div class="tx-ic recv">â‡„</div><div class="tx-info"><div class="tx-name">Swap MATIC â†’ AITK</div><div class="tx-hash">0x3b7câ€¦82a1 Â· Sample</div></div><div class="tx-right"><div class="tx-amt pos">+2,380 AITK</div><div class="tx-date">Sample data</div></div></div>`;
}

// â”€â”€ SERVICES RENDER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderServices(filter) {
  svcFilter = filter;
  const grid = $('svc-grid');
  const list = filter==='all' ? SERVICES : SERVICES.filter(s=>s.cat===filter);
  grid.innerHTML = list.map(s=>`
    <div class="svc-card" onclick="openPayModal(${JSON.stringify(s).replace(/"/g,'&quot;')})">
      <div class="svc-banner" style="background:${s.color};">${s.icon}</div>
      <div class="svc-body">
        <div class="svc-cat" style="color:var(--cyan);">${s.cat.toUpperCase()}</div>
        <div class="svc-name">${s.name}</div>
        <div class="svc-desc">${s.desc}</div>
        <div class="svc-footer">
          <div class="svc-price-wrap">
            <div class="svc-price">${Number(s.price).toLocaleString()} AITK</div>
            <div class="svc-unit">${s.unit}</div>
          </div>
          <span class="svc-badge soon" id="svc-badge-${s.key}">Loadingâ€¦</span>
        </div>
      </div>
    </div>`).join('');
  if (currentAccount) loadWallet_service_statuses();
  else SERVICES.forEach(s=>{ const el=$('svc-badge-'+s.key); if(el){el.textContent='Available';el.className='svc-badge reg';} });
}

function filterSvc(f, btn) {
  document.querySelectorAll('.filter-btn').forEach(b=>b.classList.remove('on'));
  btn.classList.add('on');
  renderServices(f);
}

// â”€â”€ CONTRACT READS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function buildReads() {
  const reads = [
    { fn:'paymentToken()',     desc:'ERC-20 token used for payments',     id:'rd-pt'   },
    { fn:'treasury()',         desc:'Address receiving platform fees',     id:'rd-tr'   },
    { fn:'platformFeeBps()',   desc:'Platform fee in basis points',        id:'rd-fee'  },
    { fn:'accumulatedFees()',  desc:'Total fees collected by contract',    id:'rd-acc'  },
  ];
  $('reads-grid').innerHTML = reads.map(r=>`
    <div class="read-card">
      <div class="read-type">â— READ</div>
      <div class="read-fn">${r.fn}</div>
      <div class="read-desc">${r.desc}</div>
      <div class="read-val" id="${r.id}">Click refresh to load</div>
    </div>`).join('');
  readContract();
}

async function readContract() {
  try {
    const r  = new ethers.Contract(ROUTER, ROUTER_ABI, readProv);
    const [pt,tr,fee,acc] = await Promise.all([
      r.paymentToken(), r.treasury(),
      r.platformFeeBps(), r.accumulatedFees(),
    ]);
    $('rd-pt').textContent  = pt;
    $('rd-tr').textContent  = tr;
    $('rd-fee').textContent = Number(fee)+' bps (='+(Number(fee)/100).toFixed(2)+'%)';
    $('rd-acc').textContent = parseFloat(ethers.formatEther(acc)).toFixed(4)+' AITK';
  } catch(e) {
    // Try switching to a different RPC and retry once
    console.warn('readContract failed, trying fallback RPC...', e);
    try {
      readProv = await getBestRPC();
      const r2  = new ethers.Contract(ROUTER, ROUTER_ABI, readProv);
      const [pt2,tr2,fee2,acc2] = await Promise.all([
        r2.paymentToken(), r2.treasury(),
        r2.platformFeeBps(), r2.accumulatedFees(),
      ]);
      $('rd-pt').textContent  = pt2;
      $('rd-tr').textContent  = tr2;
      $('rd-fee').textContent = Number(fee2)+' bps (='+(Number(fee2)/100).toFixed(2)+'%)';
      $('rd-acc').textContent = parseFloat(ethers.formatEther(acc2)).toFixed(4)+' AITK';
    } catch(e2) {
      ['rd-pt','rd-tr','rd-fee','rd-acc'].forEach(id=>$$(id, 'âš ï¸ RPC busy â€” click Refresh'));
      toast('RPC connection issue', 'Trying backup nodesâ€¦ click Refresh in a moment', 'inf');
    }
  }
}

// â”€â”€ ADD TO METAMASK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function addToMM() {
  if (!window.ethereum) { toast('No wallet','Use a browser with MetaMask','err'); return; }
  try {
    await window.ethereum.request({
      method:'wallet_watchAsset',
      params:{ type:'ERC20', options:{ address:TOKEN, symbol:'AITK', decimals:18 } },
    });
    toast('AITK added âœ“','Token now visible in your wallet','ok');
  } catch(e) { toast('Failed',e.message,'err'); }
}

async function refreshAll() {
  toast('Refreshingâ€¦','','inf');
  await loadPublic();
  if (currentAccount) await loadWallet();
  calcOut();
}

// â”€â”€ PAGE NAVIGATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showPage(name, btn, type) {
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('on'));
  $('page-'+name).classList.add('on');

  if (type==='mob') {
    document.querySelectorAll('.mob-tab').forEach(b=>b.classList.remove('on'));
    if (btn) btn.classList.add('on');
  } else {
    document.querySelectorAll('.ntab').forEach(b=>b.classList.remove('on'));
    if (btn) btn.classList.add('on');
    // Sync mobile tab too
    const mobs = document.querySelectorAll('.mob-tab');
    const pages = ['home','swap','services','portfolio','contracts'];
    const idx   = pages.indexOf(name);
    mobs.forEach((b,i)=>b.classList.toggle('on', i===idx));
  }

  // Scroll to top
  window.scrollTo({top:0, behavior:'smooth'});
}

// â”€â”€ OVERLAYS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function openOverlay(id)  { $(id).classList.add('on'); }
function closeOverlay(id) { $(id).classList.remove('on'); }
function bgClose(e,id)    { if(e.target===e.currentTarget) closeOverlay(id); }

// â”€â”€ TOAST â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function toast(title, msg, type='inf') {
  const icons = { ok:'âœ…', err:'âŒ', inf:'â„¹ï¸' };
  const stack = $('toast-stack');
  const el    = document.createElement('div');
  el.className = 'toast '+type;
  el.innerHTML = `<span class="t-icon">${icons[type]||'â„¹ï¸'}</span><div><div class="t-title">${title}</div><div class="t-msg">${msg}</div></div>`;
  stack.appendChild(el);
  requestAnimationFrame(()=>el.classList.add('in'));
  setTimeout(()=>{ el.classList.remove('in'); setTimeout(()=>el.remove(),400); }, 4500);
}

// â”€â”€ COPY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function copyTxt(txt, btn, closeInf) {
  navigator.clipboard.writeText(txt).then(()=>{
    if (btn) { btn.textContent='Copied!'; btn.style.color='var(--green)'; setTimeout(()=>{btn.textContent='Copy';btn.style.color='';},2000); }
    toast('Copied','Address copied to clipboard','ok');
    if (closeInf) closeOverlay('info-overlay');
  });
}

// â”€â”€ HELPERS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function $(id)  { return document.getElementById(id); }
function $$(ids, val) {
  if (typeof ids==='string') { const e=$(''+ids); if(e)e.textContent=val; return; }
  ids.forEach(id=>{ const e=$(id); if(e)e.textContent=val; });
}
function short(a) { return a?a.slice(0,6)+'â€¦'+a.slice(-4):''; }
function fmtBig(bn,dec) {
  const v=parseFloat(ethers.formatUnits(bn,dec));
  if(v>=1e9) return (v/1e9).toFixed(2)+'B';
  if(v>=1e6) return (v/1e6).toFixed(2)+'M';
  if(v>=1e3) return (v/1e3).toFixed(2)+'K';
  return v.toFixed(2);
}
function setBtnSwap(label, disabled) {
  const b = $('swap-btn');
  b.innerHTML = label; b.disabled = disabled;
}
function setStatus(boxId, dotId, msgId, type, msg) {
  $(boxId).style.display = 'flex';
  $(dotId).className = 's-dot '+(type==='spin'?'spin':type==='ok'?'ok':'err');
  $(msgId).textContent = msg;
}
function showLink(linkId, hash) {
  const a = $(linkId);
  if (!a) return;
  a.href = 'https://polygonscan.com/tx/'+hash;
  a.style.display = 'block';
  a.textContent   = 'View on PolygonScan â†—';
}
</script>
</body>
</html>
